(function($,gettext,document){var Marky={createSimpleToolbar:function(toolbarSel,textareaSel,options){var defaults={cannedResponses:false,privateMessaging:false};var settings=$.extend({},defaults,options);var SB=Marky.SimpleButton;var buttons=[new SB(gettext("Bold"),"'''","'''",gettext("bold text"),"btn-bold"),new SB(gettext("Italic"),"''","''",gettext("italic text"),"btn-italic"),new Marky.Separator,new Marky.LinkButton,new Marky.Separator,new SB(gettext("Numbered List"),"# ","",gettext("Numbered list item"),"btn-ol",true),new SB(gettext("Bulleted List"),"* ","",gettext("Bulleted list item"),"btn-ul",true)];if(settings.mediaButton){buttons.splice(4,0,new Marky.MediaButton)}if(settings.cannedResponses){buttons.push(new Marky.Separator,new Marky.CannedResponsesButton)}if(settings.privateMessaging){buttons.push(new Marky.Separator,new Marky.QuoteButton)}Marky.createCustomToolbar(toolbarSel,textareaSel,buttons)},createFullToolbar:function(toolbarSel,textareaSel){var SB=Marky.SimpleButton,buttons=Marky.allButtons();Marky.createCustomToolbar(toolbarSel,textareaSel,buttons)},createCustomToolbar:function(toolbarSel,textareaSel,partsArray){var $toolbar=$(toolbarSel||".editor-tools"),textarea=$(textareaSel||"#reply-content, #id_content")[0];for(var i=0,l=partsArray.length;i<l;i++){$toolbar.append(partsArray[i].bind(textarea).node())}},allButtons:function(){var SB=Marky.SimpleButton;return[new SB(gettext("Bold"),"'''","'''",gettext("bold text"),"btn-bold"),new SB(gettext("Italic"),"''","''",gettext("italic text"),"btn-italic"),new Marky.Separator,new Marky.LinkButton,new Marky.MediaButton,new Marky.Separator,new SB(gettext("Numbered List"),"# ","",gettext("Numbered list item"),"btn-ol",true),new SB(gettext("Bulleted List"),"* ","",gettext("Bulleted list item"),"btn-ul",true),new Marky.Separator,new SB(gettext("Heading 1"),"=","=",gettext("Heading 1"),"btn-h1",true),new SB(gettext("Heading 2"),"==","==",gettext("Heading 2"),"btn-h2",true),new SB(gettext("Heading 3"),"===","===",gettext("Heading 3"),"btn-h3",true)]}};Marky.SimpleButton=function(name,openTag,closeTag,defaultText,classes,everyline){this.name=name;this.classes="";this.openTag=openTag;this.closeTag=closeTag;this.defaultText=defaultText;this.everyline=everyline;if(undefined!==classes){this.classes=classes}this.html='<button class="markup-toolbar-button" />'};Marky.SimpleButton.prototype={bind:function(textarea){this.textarea=textarea;return this},render:function(){var $out=$(this.html).attr({title:this.name}).html(this.name);$out.addClass(this.classes);return $out},node:function(){var me=this,$btn=this.render();$btn.click(function(e){me.handleClick(e)});return $btn[0]},getSelectedText:function(){var selText="";if(window.codemirror&&window.highlighting.isEnabled()){var editor=window.highlighting.editor;return editor.getSelection()}if(document.selection&&document.selection.createRange){selText=document.selection.createRange().text}else if(this.textarea.selectionStart||parseInt(this.textarea.selectionStart)===0){selText=this.textarea.value.substring(this.textarea.selectionStart,this.textarea.selectionEnd)}return selText},handleClick:function(e){var selText,selStart,selEnd,splitText,range,textarea=this.textarea,scrollTop=$(textarea).scrollTop(),editor=window.highlighting&&window.highlighting.editor;if(window.codemirror&&window.highlighting&&window.highlighting.isEnabled()){selText=editor.somethingSelected()?editor.getSelection():this.defaultText;selText=this.openTag+selText+this.closeTag;editor.replaceSelection(selText);editor.focus();e.preventDefault();return false}textarea.focus();if(document.selection&&document.selection.createRange){range=document.selection.createRange();selText=range.text;if(!selText.length){selText=this.defaultText}if(this.everyline&&-~selText.indexOf("\n")){splitText=this._applyEveryLine(this.openTag,this.closeTag,selText);range.text=splitText.join("\n")}else{range.text=this.openTag+selText+this.closeTag;if(range.moveStart){range.moveStart("character",-1*this.openTag.length-selText.length);range.moveEnd("character",-1*this.closeTag.length)}}range.select()}else if(textarea.selectionStart||parseInt(textarea.selectionStart)===0){selStart=textarea.selectionStart;selEnd=textarea.selectionEnd;selText=textarea.value.substring(selStart,selEnd);if(!selText.length){selText=this.defaultText}if(this.everyline&&-~selText.indexOf("\n")){splitText=this._applyEveryLine(this.openTag,this.closeTag,selText).join("\n");textarea.value=textarea.value.substring(0,textarea.selectionStart)+splitText+textarea.value.substring(textarea.selectionEnd);textarea.selectionStart=selStart;textarea.selectionEnd=textarea.selectionStart+splitText.length}else{textarea.value=textarea.value.substring(0,textarea.selectionStart)+this.openTag+selText+this.closeTag+textarea.value.substring(textarea.selectionEnd);textarea.selectionStart=selStart+this.openTag.length;textarea.selectionEnd=textarea.selectionStart+selText.length}}$(textarea).scrollTop(scrollTop);e.preventDefault();return false},_applyEveryLine:function(opentag,closetag,block){return $.map(block.split("\n"),function(line){return line.replace(/\s+/,"").length?opentag+line+closetag:line})}};Marky.Separator=function(){this.html='<span class="separator"></span>'};Marky.Separator.prototype={node:function(){return $(this.html)[0]},bind:function(){return this}};Marky.LinkButton=function(){this.name=gettext("Insert a link...");this.classes="btn-link";this.openTag="[http://example.com ";this.closeTag="]";this.defaultText=gettext("link text");this.everyline=false;this.origOpenTag=this.openTag;this.origCloseTag=this.closeTag;this.origDefaultText=this.defaultText;this.html='<button class="markup-toolbar-button" />'};Marky.LinkButton.prototype=$.extend({},Marky.SimpleButton.prototype,{node:function(){var me=this,$btn=this.render();$btn.click(function(e){me.openModal(e)});return $btn[0]},reset:function(){this.openTag=this.origOpenTag;this.closeTag=this.origCloseTag;this.defaultText=this.origDefaultText},openModal:function(ev){var me=this,$html=$('<section class="marky">'+"<label>"+gettext("Link text:")+"</label>"+'<input type="text" name="link-text" />'+"<label>"+gettext("Link target:")+"</label>"+'<ol><li><label><input type="radio" name="link-type" value="internal" /> '+gettext("Support article:")+"</label> "+'<input type="text" name="internal" placeholder="'+gettext("Enter the name of the article")+'" /></li>'+'<li><label><input type="radio" name="link-type" value="external" /> '+gettext("External link:")+"</label> "+'<input type="text" name="external" placeholder="'+gettext("Enter the URL of the external link")+'" /></li>'+'</ol><div class="submit"><button type="button" class="btn btn-important"></button>'+'<a href="#cancel" class="kbox-cancel">'+gettext("Cancel")+"</a></div></section>"),selectedText=me.getSelectedText(),kbox;$html.find('li input[type="text"]').focus(function(){$(this).closest("li").find('input[type="radio"]').click()});var performSectionSearch=function(request){return request.term.indexOf("#")===request.term.length-1};var results=[];var getArticleURL=function(name){for(var i=0;i<results.length;i++){if(name===results[i].label){return results[i].url}}return null};var articleSearch=function(request,response){results=[];$.ajax({url:"/en-US/search",data:{format:"json",q:request.term,a:1,w:1,language:$("html").attr("lang")},dataType:"json",success:function(data,textStatus){$.map(data.results,function(val,i){results.push({label:val.title,url:val.url})});response(results)}})};var sectionSearch=function(request,response){var articleName=request.term.split("#")[0];var articleURL=getArticleURL(articleName);if(!articleURL){return}$.ajax({url:articleURL,dataType:"text",success:function(data,status){var headings=$("[id^='w_']",data);var array=[];if(headings.length===0){array.push({label:gettext("No sections found"),value:request.term.replace("#",""),target:""})}headings.each(function(){var element=this.nodeName;var level=element.substring(1);var label=$(this).text();var target=$(this).attr("id");var value=request.term+target;array.push({label:label,value:value,target:target})});response(array)}})};$html.find('input[name="internal"]').autocomplete({source:function(request,response){if(performSectionSearch(request)){sectionSearch(request,response)}else{articleSearch(request,response)}},select:function(event,ui){if(!ui.item.target){return}var $linktext=$html.find("input[name=link-text]");if($linktext.val()===""){$linktext.val(ui.item.label)}}});$html.find("button").text(gettext("Insert Link")).click(function(e){var val=$html.find('input[type="radio"]:checked').val(),text=$html.find("input[name=link-text]").val(),$internal=$html.find('input[name="internal"]'),$external=$html.find('input[name="external"]');me.reset();if(val==="internal"){var title=$internal.val();if(title){if(title===selectedText){me.openTag="[[";me.closeTag="]]";if(text){me.closeTag="|"+text+me.closeTag}}else{me.openTag="[["+title;if(text){me.openTag+="|"+text}me.openTag+="]] ";me.closeTag="";me.defaultText=""}}else{me.openTag="[[";me.closeTag="]]";if(text){me.closeTag="|"+text+"]]"}me.defaultText=gettext("Knowledge Base Article")}}else{var link=$external.val();if(link){if(link.indexOf("http")!==0){link="http://"+link}me.openTag="["+link+" ";if(text){me.openTag+=text+"] ";me.closeTag="";me.defaultText=""}}else if(text){me.defaultText=text}}me.handleClick(e);kbox.close()});if(selectedText){$html.find('input[name="internal"]').val(selectedText).focus()}kbox=new KBox($html,{title:this.name,destroy:true,modal:true,id:"link-modal",container:$("body")});kbox.open();ev.preventDefault();return false}});Marky.MediaButton=function(){this.name=gettext("Insert media...");this.classes="btn-media";this.openTag="";this.closeTag="";this.defaultText=gettext("media");this.everyline=false;this.html='<button class="markup-toolbar-button" />'};Marky.MediaButton.prototype=$.extend({},Marky.SimpleButton.prototype,{node:function(){var me=this,$btn=this.render();$btn.click(function(e){me.openModal(e)});return $btn[0]},reset:function(){this.openTag="";this.closeTag="";this.defaultText=""},openModal:function(ev){var me=this,$editor=$(me.textarea).closest(".editor"),mediaSearchUrl=$editor.data("media-search-url"),galleryUrl=$editor.data("media-gallery-url"),$html=$('<section class="marky">'+'<div class="filter cf">'+'<form class="simple-search-form" id="gallery-modal-search"><input type="text" name="q" class="searchbox"'+'placeholder="'+gettext("Search Gallery")+'" />'+'<button type="submit" class="submit-button" title="'+gettext("Search Gallery")+'">'+gettext("Search Gallery")+"</button></form>"+'<div class="type">'+"<span>"+gettext("Show:")+"</span>"+'<ol><li data-type="image" class="selected">'+gettext("Images")+"</li>"+'<li data-type="video">'+gettext("Videos")+"</li></ol></div>"+'<div class="locale-filter">'+gettext("Show media for:")+" <select /></div></div>"+'<div class="placeholder" /><div class="submit">'+'<button class="btn btn-important">'+gettext("Insert Media")+"</button>"+'<a href="'+galleryUrl+'#upload" class="upload" target="_blank">'+gettext("Upload Media")+"</a>"+'<a href="#cancel" class="kbox-cancel">'+gettext("Cancel")+"</a></div>"+"</section>"),selectedText=me.getSelectedText(),mediaType=$html.find("div.type li.selected").data("type"),mediaQ="",mediaLocale=$("html").attr("lang"),mediaPage=1,kbox;$html.find("div.type li").click(function(e){var $this=$(this);if(!$this.is(".selected")){$html.find("div.type li.selected").removeClass("selected");$this.addClass("selected");mediaType=$this.data("type");mediaPage=1;updateResults()}e.preventDefault();return false});var $lf=$html.find("div.locale-filter select");$lf.html($("#_languages-select-box").html());$lf.on("change",function(){mediaPage=1;mediaLocale=$(this).val();updateResults()});$html.find("form#gallery-modal-search").submit(function(e){mediaQ=$html.find('input[name="q"]').val();mediaPage=1;updateResults();e.preventDefault();return false});$html.find("a.upload").click(function(e){kbox.close()});$html.delegate("ol.pagination a","click",function(e){mediaPage=parseInt($(this).attr("href").split("&page=")[1],10);updateResults();e.preventDefault();return false});$html.find("div.submit button").click(function(e){me.reset();var $selected=$html.find("#media-list > li.selected");if($selected.length<1){alert(gettext("Please select an image or video to insert."));return false}me.openTag="[[";me.openTag+=mediaType==="image"?"Image":"Video";me.openTag+=":"+$selected.find("a").attr("title")+"]] ";me.handleClick(e);kbox.close()});updateResults();function updateResults(type,q){$html.addClass("processing");$.ajax({url:mediaSearchUrl,type:"GET",data:{type:mediaType,q:mediaQ,page:mediaPage,locale:mediaLocale},dataType:"html",success:function(html){$html.find("div.placeholder").html(html);$html.find("#media-list > li").click(function(e){var $this=$(this),$mediaList=$(this).parent();$mediaList.find("li.selected").removeClass("selected");$this.addClass("selected");e.preventDefault();return false})},error:function(){var message=gettext("Oops, there was an error.");$html.find("div.placeholder").html('<div class="msg">'+message+"</div>")},complete:function(){$html.removeClass("processing")}})}kbox=new KBox($html,{title:this.name,destroy:true,modal:true,id:"media-modal",container:$("body"),position:"none"});kbox.open();ev.preventDefault();return false}});Marky.CannedResponsesButton=function(){this.name=gettext("Common responses");this.classes="btn-cannedresponses";this.openTag="";this.closeTag="";this.defaultText=gettext("cannedresponses");this.everyline=false;this.html='<a class="markup-toolbar-link" href="#"/>'};Marky.CannedResponsesButton.prototype=$.extend({},Marky.SimpleButton.prototype,{node:function(){var me=this,$btn=this.render();$btn.click(function(e){me.openModal(e)});me.getPermissionBits();return $btn[0]},reset:function(){this.openTag="";this.closeTag="";this.defaultText=""},openModal:function(e){var me=this,$editor=$(me.textarea).closest(".editor"),$html=$('<section class="marky">'+'<div class="search simple-search-form">'+'<input type="text" name="q" id="filter-responses-field" placeholder="'+gettext("Search for common responses")+'" class="searchbox"/>'+"</div></div>"+'<div class="area">'+'<div id="responses-area">'+'<h2 class="heading-label">'+gettext("Categories")+"</h2>"+'<ul class="category-list sidebar-nav">'+'<li class="status-indicator busy">'+gettext("Loading...")+"</li>"+"</ul></div>"+'<div id="response-list-area">'+'<h2 class="heading-label">'+gettext("Responses")+"</h2>"+'<h4 class="nocat-label">'+gettext("Please select a category from the previous column or start a search.")+"</h4>"+'<p class="response-list"/>'+"</div>"+'<div id="response-content-area">'+'<h2 class="heading-label preview-label">'+gettext("Response editor")+"</h2>"+'<button class="toggle-view btn">'+gettext("Switch to preview mode")+"</button>"+'<p class="response-preview">'+'<textarea id="response-content">'+"</textarea></p>"+'<p class="response-preview-rendered"></p>'+"</div>"+"</div>"+"</div>"+'<div class="placeholder" /><div class="submit" id="response-submit-area">'+'<button id="insert-response" class="btn btn-important">'+gettext("Insert Response")+"</button>"+'<a href="#cancel" class="kbox-cancel">'+gettext("Cancel")+"</a>"+"</div>"+"</section>"),selectedText=me.getSelectedText(),kbox;var cannedResponsesUrl="/kb/common-forum-responses";var previewUrl="answer-preview-async";function updatePreview(){var response=$("#response-content").val();var token=$("[name=csrfmiddlewaretoken]").attr("value");toggleThrobber(true);$.ajax({type:"POST",url:previewUrl,data:{content:response,csrfmiddlewaretoken:token},dataType:"html",success:function(html){var $container=$(".response-preview-rendered");var $response_preview=$(html).find(".main-content");$container.html($response_preview)},complete:function(){toggleThrobber(false)}})}function getContent(articleUrl){if(!articleUrl||articleUrl.indexOf("/new")!==-1){return}toggleThrobber(true);$.ajax({url:articleUrl+"/edit",dataType:"html",success:function(data,status){var article_src=$("#id_content",data).val();var $textbox=$("#response-content");$textbox.val(article_src);$textbox.data("slug",articleUrl);updatePreview()},complete:function(){toggleThrobber(false)}})}function toggleThrobber(busy){var $label=$(".preview-label");if(busy){$label.addClass("busy")}else{$label.removeClass("busy")}}function isAllowedToUseResponse(response_target){if(response_target.indexOf("#")===-1){return true}var articleUrl=response_target.split("#")[0];var permBits=response_target.split("#")[1];response_target=articleUrl;for(var i=0;i<permBits.length;i++){var bit=permBits[i];if(me.permissionBits.indexOf(bit)!==-1){return true}}return false}function insertResponse(){var sourceContent=$("#response-content").val();var slug=$("#response-content").data("slug");var $responseTextbox=$("#id_content");var targetContent=$responseTextbox.val();trackEvent("Canned response usage",slug);$responseTextbox.val(targetContent+sourceContent)}function searchResponses(term){term=term.toLowerCase().trim();var $searchHeading=$html.find("#response-list-area .heading-label");var $noCategorySelected=$html.find(".nocat-label");var $responseLists=$html.find(".response-list ul");var $responses=$html.find(".response");var $responseListArea=$html.find("#response-list-area");var $responsesArea=$html.find("#responses-area");if(term===""){$searchHeading.text(gettext("Responses"));$responseListArea.removeClass("filtered");$responsesArea.removeClass("filtered");$noCategorySelected.show();$responses.show();$responseLists.hide();return}$responseListArea.addClass("filtered");$responsesArea.addClass("filtered");$searchHeading.text(gettext("Matching responses"));$noCategorySelected.hide();$responseLists.show();$responses.each(function(){var text=$(this).text().toLowerCase();if(text.indexOf(term)===-1){$(this).hide()}else{$(this).show()}})}function loadCannedResponses(){var siteLanguage=window.location.pathname.split("/")[1];var targetUrl="/"+siteLanguage+cannedResponsesUrl;$.ajax({url:targetUrl,type:"GET",dataType:"html",success:function(html){var $categoryList=$(".category-list"),$responsesList=$(".response-list"),$categories=$(html).find("[id^=w_]");$categoryList.empty();$responsesList.empty();$categories.each(function(){var label=$(this).text(),$headingItem=$(document.createElement("li")),$responses=$(document.createElement("ul")).addClass("sidebar-nav").hide(),$catResponses=$(this).nextUntil("[id^=w_]").find("a"),$noCatLabel=$html.find(".nocat-label"),$otherResponses,$otherHeadings;$catResponses.each(function(){var $response=$(document.createElement("li")).addClass("response").text($(this).text());var response_target=$(this).attr("href");var canUseResponse=isAllowedToUseResponse(response_target);response_target=response_target.split("#")[0];if(canUseResponse){$response.click(function(){$(".response-list li").not($(this)).removeClass("selected");$(this).addClass("selected");getContent(response_target)});$responses.append($response)}});$headingItem.addClass("response-heading").text(label).on("click",function(){$noCatLabel.hide();$otherResponses=$responsesList.find("ul").not($responses);$otherResponses.hide();$otherHeadings=$categoryList.find(".response-heading").not($headingItem);$otherHeadings.removeClass("selected");$(this).addClass("selected");$responses.show()});$categoryList.append($headingItem);$responsesList.append($responses)})},error:function(){var statusIndicator=$(".status-indicator");statusIndicator.removeClass("busy");statusIndicator.text(gettext("There was an error checking for canned responses."))}});return true}kbox=new KBox($html,{title:this.name,destroy:true,modal:true,id:"media-modal",container:$("body"),position:"none",preOpen:loadCannedResponses});kbox.open();$html.find("#insert-response").click(function(){insertResponse();kbox.close()});$html.find("#filter-responses-field").keyup(function(){var term=$(this).val();searchResponses(term)});var $previewLabel=$html.find(".preview-label");var $contentArea=$html.find(".response-preview");var $renderedPreview=$html.find(".response-preview-rendered");$html.find(".toggle-view").toggle(function(){updatePreview();$previewLabel.text(gettext("Response preview"));$(this).text(gettext("Switch to edit mode"));$contentArea.hide();$renderedPreview.show()},function(){$previewLabel.text(gettext("Response editor"));$(this).text(gettext("Switch to preview mode"));$contentArea.show();$renderedPreview.hide()});e.preventDefault();return false},permissionBits:[],getPermissionBits:function(){var profile_link=$("#aux-nav .user").attr("href"),me=this;if(!profile_link||profile_link===""){return}$.ajax({url:profile_link,dataType:"html",success:function(data,status){var userGroups=$("#groups li",data);userGroups.each(function(){var group=$(this).text();if(group==="Contributors"){me.permissionBits.push("c")}if(group==="Forum Moderators"){me.permissionBits.push("m")}if(group==="Administrators"){me.permissionBits.push("a")}})}})}});Marky.QuoteButton=function(){var name=gettext("Quote previous message...");var previousContent=$("#read-message").attr("data-message-content");var previousAuthor=$(".from a").text();var previousAuthorLink=$(".from a").attr("href");var quote="["+previousAuthorLink+" "+previousAuthor+"] "+gettext("said")+"\r\n";quote+="<blockquote>\r\n";quote+=previousContent+"\r\n";quote+="</blockquote>\r\n";return new Marky.SimpleButton(name,quote,"","","btn-quote",true)};window.Marky=Marky})(jQuery,gettext,document);var LATIN_MAP={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ő":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ű":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ő":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ű":"u","ý":"y","þ":"th","ÿ":"y"};var LATIN_SYMBOLS_MAP={"©":"(c)"};var GREEK_MAP={"α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ά":"a","έ":"e","ί":"i","ό":"o","ύ":"y","ή":"h","ώ":"w","ς":"s","ϊ":"i","ΰ":"y","ϋ":"y","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Ά":"A","Έ":"E","Ί":"I","Ό":"O","Ύ":"Y","Ή":"H","Ώ":"W","Ϊ":"I","Ϋ":"Y"};var TURKISH_MAP={"ş":"s","Ş":"S","ı":"i","İ":"I","ç":"c","Ç":"C","ü":"u","Ü":"U","ö":"o","Ö":"O","ğ":"g","Ğ":"G"};var RUSSIAN_MAP={"а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"yo","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ё":"Yo","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya"};var UKRAINIAN_MAP={"Є":"Ye","І":"I","Ї":"Yi","Ґ":"G","є":"ye","і":"i","ї":"yi","ґ":"g"};var CZECH_MAP={"č":"c","ď":"d","ě":"e","ň":"n","ř":"r","š":"s","ť":"t","ů":"u","ž":"z","Č":"C","Ď":"D","Ě":"E","Ň":"N","Ř":"R","Š":"S","Ť":"T","Ů":"U","Ž":"Z"};var POLISH_MAP={"ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ó":"o","ś":"s","ź":"z","ż":"z","Ą":"A","Ć":"C","Ę":"e","Ł":"L","Ń":"N","Ó":"o","Ś":"S","Ź":"Z","Ż":"Z"};var LATVIAN_MAP={"ā":"a","č":"c","ē":"e","ģ":"g","ī":"i","ķ":"k","ļ":"l","ņ":"n","š":"s","ū":"u","ž":"z","Ā":"A","Č":"C","Ē":"E","Ģ":"G","Ī":"i","Ķ":"k","Ļ":"L","Ņ":"N","Š":"S","Ū":"u","Ž":"Z"};var ALL_DOWNCODE_MAPS=new Array;ALL_DOWNCODE_MAPS[0]=LATIN_MAP;ALL_DOWNCODE_MAPS[1]=LATIN_SYMBOLS_MAP;ALL_DOWNCODE_MAPS[2]=GREEK_MAP;ALL_DOWNCODE_MAPS[3]=TURKISH_MAP;ALL_DOWNCODE_MAPS[4]=RUSSIAN_MAP;ALL_DOWNCODE_MAPS[5]=UKRAINIAN_MAP;ALL_DOWNCODE_MAPS[6]=CZECH_MAP;ALL_DOWNCODE_MAPS[7]=POLISH_MAP;ALL_DOWNCODE_MAPS[8]=LATVIAN_MAP;var Downcoder=new Object;Downcoder.Initialize=function(){if(Downcoder.map)return;Downcoder.map={};Downcoder.chars="";for(var i in ALL_DOWNCODE_MAPS){var lookup=ALL_DOWNCODE_MAPS[i];for(var c in lookup){Downcoder.map[c]=lookup[c];Downcoder.chars+=c}}Downcoder.regex=new RegExp("["+Downcoder.chars+"]|[^"+Downcoder.chars+"]+","g")};downcode=function(slug){Downcoder.Initialize();var downcoded="";var pieces=slug.match(Downcoder.regex);if(pieces){for(var i=0;i<pieces.length;i++){if(pieces[i].length==1){var mapped=Downcoder.map[pieces[i]];if(mapped!=null){downcoded+=mapped;continue}}downcoded+=pieces[i]}}else{downcoded=slug}return downcoded};function URLify(s,num_chars){s=downcode(s);removelist=["a","an","as","at","before","but","by","for","from","is","in","into","like","of","off","on","onto","per","since","than","the","this","that","to","up","via","with"];r=new RegExp("\\b("+removelist.join("|")+")\\b","gi");s=s.replace(r,"");s=s.replace(/[^-\w\s]/g,"");s=s.replace(/^\s+|\s+$/g,"");s=s.replace(/[-\s]+/g,"-");s=s.toLowerCase();return s.substring(0,num_chars)}(function($){$.fn.prepopulate=function(dependencies,maxLength){return this.each(function(){var field=$(this);field.data("_changed",false);field.change(function(){field.data("_changed",true)});var populate=function(){if(field.data("_changed")==true)return;var values=[],field_val,field_val_raw;dependencies.each(function(){if($(this).val().length>0){values.push($(this).val())}});field_val_raw=values.join(" ");field_val=URLify(field_val_raw,maxLength)||field_val_raw;field.val(field_val)};dependencies.change(populate)})}})(jQuery);(function($){$.fn.lazyload=function(options){var opts=$.extend($.fn.lazyload.defaults,options);var elements=this;var didScroll=false;loaded=elements.length;$(window).bind("scroll",function(e){didScroll=true});loadAboveTheFoldImages(elements,opts,null);$(window).trigger("scroll");var prevHash=window.location.hash;resetHashPosition();var intv=setInterval(function(){if(loaded<=0){$(window).unbind("scroll");clearInterval(intv);return}if(didScroll){didScroll=false;if(prevHash!=window.location.hash){assocAnchor=window.location.hash;prevHash=window.location.hash}else{assocAnchor=null}loadedCount=loadAboveTheFoldImages(elements,opts,assocAnchor);loaded-=loadedCount}},250);return this};$.fn.lazyload.defaults={threshold:750};function resetHashPosition(){if(window.location.hash){window.location.hash=window.location.hash}}function aboveTheFold(element,options){var fold=$(window).height()+$(window).scrollTop();return fold>=$(element).offset().top-options["threshold"]}$.fn.lazyload.loadOriginalImage=function(element,assocAnchor){if(assocAnchor!=null){$(element).load(function(){resetHashPosition()})}$(element).attr("src",$(element).data("original-src")).removeData("original-src")};$.fn.loadnow=function(options){var elements=this;elements.each(function(){$.fn.lazyload.loadOriginalImage(this);$(this).removeClass("lazy")})};function loadAboveTheFoldImages(elements,options,assocAnchor){var loaded=0;elements.filter(".lazy").each(function(){if($(this).hasClass("lazy")&&aboveTheFold(this,options)&&$(this).data("original-src")&&$(this).is(":visible")){$.fn.lazyload.loadOriginalImage(this,assocAnchor);$(this).removeClass("lazy");loaded++}});return loaded}})(jQuery);(function($){var DEFAULT_SETTINGS={method:"GET",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,contentType:"json",prePopulate:null,processPrePopulate:false,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&times;",animateDropdown:true,theme:null,resultsFormatter:function(item){return"<li>"+item[this.propertyToSearch]+"</li>"},tokenFormatter:function(item){return"<li><p>"+item[this.propertyToSearch]+"</p></li>"},tokenLimit:null,tokenDelimiter:",",preventDuplicates:false,tokenValue:"id",onResult:null,onAdd:null,onDelete:null,onReady:null,idPrefix:"token-input-",disabled:false};var DEFAULT_CLASSES={tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token",disabled:"token-input-disabled"};var POSITION={BEFORE:0,AFTER:1,END:2};var KEY={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188};var methods={init:function(url_or_data_or_function,options){var settings=$.extend({},DEFAULT_SETTINGS,options||{});return this.each(function(){$(this).data("tokenInputObject",new $.TokenList(this,url_or_data_or_function,settings))})},clear:function(){this.data("tokenInputObject").clear();return this},add:function(item){this.data("tokenInputObject").add(item);return this},remove:function(item){this.data("tokenInputObject").remove(item);return this},get:function(){return this.data("tokenInputObject").getTokens()},toggleDisabled:function(disable){this.data("tokenInputObject").toggleDisabled(disable);return this}};$.fn.tokenInput=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else{return methods.init.apply(this,arguments)}};$.TokenList=function(input,url_or_data,settings){if($.type(url_or_data)==="string"||$.type(url_or_data)==="function"){settings.url=url_or_data;var url=computeURL();if(settings.crossDomain===undefined){if(url.indexOf("://")===-1){settings.crossDomain=false}else{settings.crossDomain=location.href.split(/\/+/g)[1]!==url.split(/\/+/g)[1]}}}else if(typeof url_or_data==="object"){settings.local_data=url_or_data}if(settings.classes){settings.classes=$.extend({},DEFAULT_CLASSES,settings.classes)}else if(settings.theme){settings.classes={};$.each(DEFAULT_CLASSES,function(key,value){settings.classes[key]=value+"-"+settings.theme})}else{settings.classes=DEFAULT_CLASSES}var saved_tokens=[];var token_count=0;var cache=new $.TokenList.Cache;var timeout;var input_val;var input_box=$('<input type="text"  autocomplete="off">').css({outline:"none"}).attr("id",settings.idPrefix+input.id).focus(function(){if(settings.disabled){return false}else if(settings.tokenLimit===null||settings.tokenLimit!==token_count){show_dropdown_hint()}}).blur(function(){hide_dropdown();$(this).val("")}).bind("keyup keydown blur update",resize_input).keydown(function(event){var previous_token;var next_token;switch(event.keyCode){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:if(!$(this).val()){previous_token=input_token.prev();next_token=input_token.next();if(previous_token.length&&previous_token.get(0)===selected_token||next_token.length&&next_token.get(0)===selected_token){if(event.keyCode===KEY.LEFT||event.keyCode===KEY.UP){deselect_token($(selected_token),POSITION.BEFORE)}else{deselect_token($(selected_token),POSITION.AFTER)}}else if((event.keyCode===KEY.LEFT||event.keyCode===KEY.UP)&&previous_token.length){select_token($(previous_token.get(0)))}else if((event.keyCode===KEY.RIGHT||event.keyCode===KEY.DOWN)&&next_token.length){select_token($(next_token.get(0)))}}else{var dropdown_item=null;if(event.keyCode===KEY.DOWN||event.keyCode===KEY.RIGHT){dropdown_item=$(selected_dropdown_item).next()}else{dropdown_item=$(selected_dropdown_item).prev()}if(dropdown_item.length){select_dropdown_item(dropdown_item)}return false}break;case KEY.BACKSPACE:previous_token=input_token.prev();if(!$(this).val().length){if(selected_token){delete_token($(selected_token));hidden_input.change()}else if(previous_token.length){select_token($(previous_token.get(0)))}return false}else if($(this).val().length===1){
hide_dropdown()}else{setTimeout(function(){do_search()},5)}break;case KEY.TAB:case KEY.ENTER:case KEY.NUMPAD_ENTER:case KEY.COMMA:if(selected_dropdown_item){add_token($(selected_dropdown_item).data("tokeninput"));hidden_input.change();return false}break;case KEY.ESCAPE:hide_dropdown();return true;default:if(String.fromCharCode(event.which)){setTimeout(function(){do_search()},5)}break}});var hidden_input=$(input).hide().val("").focus(function(){input_box.focus()}).blur(function(){input_box.blur()});var selected_token=null;var selected_token_index=0;var selected_dropdown_item=null;var token_list=$("<ul />").addClass(settings.classes.tokenList).click(function(event){var li=$(event.target).closest("li");if(li&&li.get(0)&&$.data(li.get(0),"tokeninput")){toggle_select_token(li)}else{if(selected_token){deselect_token($(selected_token),POSITION.END)}input_box.focus()}}).mouseover(function(event){var li=$(event.target).closest("li");if(li&&selected_token!==this){li.addClass(settings.classes.highlightedToken)}}).mouseout(function(event){var li=$(event.target).closest("li");if(li&&selected_token!==this){li.removeClass(settings.classes.highlightedToken)}}).insertBefore(hidden_input);var input_token=$("<li />").addClass(settings.classes.inputToken).appendTo(token_list).append(input_box);var dropdown=$("<div>").addClass(settings.classes.dropdown).appendTo("body").hide();var input_resizer=$("<tester/>").insertAfter(input_box).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:input_box.css("fontSize"),fontFamily:input_box.css("fontFamily"),fontWeight:input_box.css("fontWeight"),letterSpacing:input_box.css("letterSpacing"),whiteSpace:"nowrap"});hidden_input.val("");var li_data=settings.prePopulate||hidden_input.data("pre");if(settings.processPrePopulate&&$.isFunction(settings.onResult)){li_data=settings.onResult.call(hidden_input,li_data)}if(li_data&&li_data.length){$.each(li_data,function(index,value){insert_token(value);checkTokenLimit()})}if(settings.disabled){toggleDisabled(true)}if($.isFunction(settings.onReady)){settings.onReady.call()}this.clear=function(){token_list.children("li").each(function(){if($(this).children("input").length===0){delete_token($(this))}})};this.add=function(item){add_token(item)};this.remove=function(item){token_list.children("li").each(function(){if($(this).children("input").length===0){var currToken=$(this).data("tokeninput");var match=true;for(var prop in item){if(item[prop]!==currToken[prop]){match=false;break}}if(match){delete_token($(this))}}})};this.getTokens=function(){return saved_tokens};this.toggleDisabled=function(disable){toggleDisabled(disable)};function toggleDisabled(disable){if(typeof disable==="boolean"){settings.disabled=disable}else{settings.disabled=!settings.disabled}input_box.prop("disabled",settings.disabled);token_list.toggleClass(settings.classes.disabled,settings.disabled);if(selected_token){deselect_token($(selected_token),POSITION.END)}hidden_input.prop("disabled",settings.disabled)}function checkTokenLimit(){if(settings.tokenLimit!==null&&token_count>=settings.tokenLimit){input_box.hide();hide_dropdown();return}}function resize_input(){if(input_val===(input_val=input_box.val())){return}var escaped=input_val.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");input_resizer.html(escaped);input_box.width(input_resizer.width()+30)}function is_printable_character(keycode){return keycode>=48&&keycode<=90||keycode>=96&&keycode<=111||keycode>=186&&keycode<=192||keycode>=219&&keycode<=222}function insert_token(item){var this_token=settings.tokenFormatter(item);this_token=$(this_token).addClass(settings.classes.token).insertBefore(input_token);$("<span>"+settings.deleteText+"</span>").addClass(settings.classes.tokenDelete).appendTo(this_token).click(function(){if(!settings.disabled){delete_token($(this).parent());hidden_input.change();return false}});var token_data=item;$.data(this_token.get(0),"tokeninput",item);saved_tokens=saved_tokens.slice(0,selected_token_index).concat([token_data]).concat(saved_tokens.slice(selected_token_index));selected_token_index++;update_hidden_input(saved_tokens,hidden_input);token_count+=1;if(settings.tokenLimit!==null&&token_count>=settings.tokenLimit){input_box.hide();hide_dropdown()}return this_token}function add_token(item){var callback=settings.onAdd;if(token_count>0&&settings.preventDuplicates){var found_existing_token=null;token_list.children().each(function(){var existing_token=$(this);var existing_data=$.data(existing_token.get(0),"tokeninput");if(existing_data&&existing_data.id===item.id){found_existing_token=existing_token;return false}});if(found_existing_token){select_token(found_existing_token);input_token.insertAfter(found_existing_token);input_box.focus();return}}if(settings.tokenLimit==null||token_count<settings.tokenLimit){insert_token(item);checkTokenLimit()}input_box.val("");hide_dropdown();if($.isFunction(callback)){callback.call(hidden_input,item)}}function select_token(token){if(!settings.disabled){token.addClass(settings.classes.selectedToken);selected_token=token.get(0);input_box.val("");hide_dropdown()}}function deselect_token(token,position){token.removeClass(settings.classes.selectedToken);selected_token=null;if(position===POSITION.BEFORE){input_token.insertBefore(token);selected_token_index--}else if(position===POSITION.AFTER){input_token.insertAfter(token);selected_token_index++}else{input_token.appendTo(token_list);selected_token_index=token_count}input_box.focus()}function toggle_select_token(token){var previous_selected_token=selected_token;if(selected_token){deselect_token($(selected_token),POSITION.END)}if(previous_selected_token===token.get(0)){deselect_token(token,POSITION.END)}else{select_token(token)}}function delete_token(token){var token_data=$.data(token.get(0),"tokeninput");var callback=settings.onDelete;var index=token.prevAll().length;if(index>selected_token_index)index--;token.remove();selected_token=null;input_box.focus();saved_tokens=saved_tokens.slice(0,index).concat(saved_tokens.slice(index+1));if(index<selected_token_index)selected_token_index--;update_hidden_input(saved_tokens,hidden_input);token_count-=1;if(settings.tokenLimit!==null){input_box.show().val("").focus()}if($.isFunction(callback)){callback.call(hidden_input,token_data)}}function update_hidden_input(saved_tokens,hidden_input){var token_values=$.map(saved_tokens,function(el){if(typeof settings.tokenValue=="function")return settings.tokenValue.call(this,el);return el[settings.tokenValue]});hidden_input.val(token_values.join(settings.tokenDelimiter))}function hide_dropdown(){dropdown.hide().empty();selected_dropdown_item=null}function show_dropdown(){dropdown.css({position:"absolute",top:$(token_list).offset().top+$(token_list).outerHeight(),left:$(token_list).offset().left,width:$(token_list).width(),"z-index":999}).show()}function show_dropdown_searching(){if(settings.searchingText){dropdown.html("<p>"+settings.searchingText+"</p>");show_dropdown()}}function show_dropdown_hint(){if(settings.hintText){dropdown.html("<p>"+settings.hintText+"</p>");show_dropdown()}}function highlight_term(value,term){return value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+term+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")}function find_value_and_highlight_term(template,value,term){return template.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+value+")(?![^<>]*>)(?![^&;]+;)","g"),highlight_term(value,term))}function populate_dropdown(query,results){if(results&&results.length){dropdown.empty();var dropdown_ul=$("<ul>").appendTo(dropdown).mouseover(function(event){select_dropdown_item($(event.target).closest("li"))}).mousedown(function(event){add_token($(event.target).closest("li").data("tokeninput"));hidden_input.change();return false}).hide();$.each(results,function(index,value){var this_li=settings.resultsFormatter(value);this_li=find_value_and_highlight_term(this_li,value[settings.propertyToSearch],query);this_li=$(this_li).appendTo(dropdown_ul);if(index%2){this_li.addClass(settings.classes.dropdownItem)}else{this_li.addClass(settings.classes.dropdownItem2)}if(index===0){select_dropdown_item(this_li)}$.data(this_li.get(0),"tokeninput",value)});show_dropdown();if(settings.animateDropdown){dropdown_ul.slideDown("fast")}else{dropdown_ul.show()}}else{if(settings.noResultsText){dropdown.html("<p>"+settings.noResultsText+"</p>");show_dropdown()}}}function select_dropdown_item(item){if(item){if(selected_dropdown_item){deselect_dropdown_item($(selected_dropdown_item))}item.addClass(settings.classes.selectedDropdownItem);selected_dropdown_item=item.get(0)}}function deselect_dropdown_item(item){item.removeClass(settings.classes.selectedDropdownItem);selected_dropdown_item=null}function do_search(){var query=input_box.val();if(query&&query.length){if(selected_token){deselect_token($(selected_token),POSITION.AFTER)}if(query.length>=settings.minChars){show_dropdown_searching();clearTimeout(timeout);timeout=setTimeout(function(){run_search(query)},settings.searchDelay)}else{hide_dropdown()}}}function run_search(query){var cache_key=query+computeURL();var cached_results=cache.get(cache_key);if(cached_results){populate_dropdown(query,cached_results)}else{if(settings.url){var url=computeURL();var ajax_params={};ajax_params.data={};if(url.indexOf("?")>-1){var parts=url.split("?");ajax_params.url=parts[0];var param_array=parts[1].split("&");$.each(param_array,function(index,value){var kv=value.split("=");ajax_params.data[kv[0]]=kv[1]})}else{ajax_params.url=url}ajax_params.data[settings.queryParam]=query;ajax_params.type=settings.method;ajax_params.dataType=settings.contentType;if(settings.crossDomain){ajax_params.dataType="jsonp"}ajax_params.success=function(results){if($.isFunction(settings.onResult)){results=settings.onResult.call(hidden_input,results)}cache.add(cache_key,settings.jsonContainer?results[settings.jsonContainer]:results);if(input_box.val()===query){populate_dropdown(query,settings.jsonContainer?results[settings.jsonContainer]:results)}};$.ajax(ajax_params)}else if(settings.local_data){var results=$.grep(settings.local_data,function(row){return row[settings.propertyToSearch].toLowerCase().indexOf(query.toLowerCase())>-1});if($.isFunction(settings.onResult)){results=settings.onResult.call(hidden_input,results)}cache.add(cache_key,results);populate_dropdown(query,results)}}}function computeURL(){var url=settings.url;if(typeof settings.url=="function"){url=settings.url.call(settings)}return url}};$.TokenList.Cache=function(options){var settings=$.extend({max_size:500},options);var data={};var size=0;var flush=function(){data={};size=0};this.add=function(query,results){if(size>settings.max_size){flush()}if(!data[query]){size+=1}data[query]=results};this.get=function(query){return data[query]}}})(jQuery);(function($){"use strict";function init(){function wrapTerm(string,term){term=(term+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1");var regex=new RegExp("("+term+")","gi");return string.replace(regex,"<strong>$1</strong>")}var prefill=[];if($("#id_to").val()){prefill=$("#id_to").val().split(",").map(function(username){return{username:k.safeString(username),display_name:null}})}var tokenInputSettings={theme:"facebook",hintText:gettext("Search for a user..."),queryParam:"term",propertyToSearch:"username",tokenValue:"username",prePopulate:prefill,resultsFormatter:function(item){var term=$("#token-input-id_to").val();if(item.display_name){return k.safeInterpolate('<li><img src="%(avatar)s"/><div class="name_search">%(display_name)s [%(username)s]</div></li>',item,true)}return k.safeInterpolate('<li><img src="%(avatar)s"/><div class="name_search">%(username)s</div></li>',item,true)},onAdd:function(item){$(this).closest(".single").closest("form").submit()}};$("input.user-autocomplete").tokenInput($("body").data("usernames-api"),tokenInputSettings)}$(document).ready(init)})(jQuery);(function(){var VIDEO_ID_PREFIX="video-flash-",id_counter=0,FLASH_VERSION="9.0.0",params={allowfullscreen:"true"},flashvars={autoload:1,showtime:1,showvolume:1};function initVideoFallback($video){if($video[0].tagName.toUpperCase()!=="VIDEO"){return}var formats={ogg:false,webm:false},i,width=Number($video.data("width")),height=Number($video.data("height")),unique_id=VIDEO_ID_PREFIX+id_counter,flash_file;id_counter++;$video.attr("id",unique_id);$("source",$video).each(function checkSourceFormats(){for(i in formats){if($(this).attr("type").indexOf(i)>-1){formats[i]=true}}});if(Modernizr.video&&(formats.webm&&Modernizr.video.webm)||formats.ogg&&Modernizr.video.ogg){return}flash_file=$video.data("fallback");if(flash_file.substr(-4)===".swf"){swfobject.embedSWF(flash_file,unique_id,width,height,FLASH_VERSION,k.STATIC_URL+"/media/swf/expressInstall.swf",flashvars,params)}else if(flash_file){flashvars.flv=flash_file;swfobject.embedSWF(k.STATIC_URL+"swf/screencast.swf",unique_id,width,height,FLASH_VERSION,k.STATIC_URL+"/media/swf/expressInstall.swf",flashvars,params)}else{$video.hide()}}function initFallbackSupport(){}})();(function($){"use strict";function ShowFor($container){this.$container=$container||$("body");this.state={};this.loadData();this.initEvents();this.updateUI();this.updateState();this.wrapTOCs();this.initShowFuncs();this.showAndHide()}ShowFor.prototype.productShortMap={fx:"firefox",m:"mobile",fxos:"firefox-os",tb:"thunderbird"};ShowFor.prototype.loadData=function(){try{this.data=JSON.parse(this.$container.find(".showfor-data").html())}catch(e){this.data={products:[],platforms:[],versions:[]}}this.productSlugs=this.data.products.map(function(prod){return prod.slug});this.platformSlugs=[];for(var product in this.data.platforms){this.data.platforms[product].forEach(function(platform){this.platformSlugs.push(platform.slug)}.bind(this))}this.versionSlugs={};for(var prod in this.data.versions){this.data.versions[prod].forEach(function(version){this.versionSlugs[version.slug]=prod}.bind(this))}};ShowFor.prototype.initEvents=function(){window.onpopstate=this.updateUI.bind(this);this.$container.on("change keyup","input, select",this.onUIChange.bind(this))};ShowFor.prototype.ensureSelect=function($select,type,product,val){var $opt;var key;var extra={};var target;function select(searchArray,slug){for(var i=0;i<searchArray.length;i++){if(searchArray[i].slug===slug){return searchArray[i]}}return null}if(type==="version"){target=select(this.data.versions[product],val);if(target!==null){extra["data-min"]=target.min_version;extra["data-max"]=target.max_version}}else if(type==="platform"){target=select(this.data.platforms[product],val)}else if(type==="product"){target=select(this.data.products,val)}else{throw new Error("Unknown showfor select type "+type)}if(target===null){return}val=type+":"+val;if($select.find('option[value="'+val+'"]').length===0){$opt=$("<option>").attr("value",val).text(target.name);for(key in extra){$opt.attr(key,extra[key])}$select.append($opt)}$select.val(val)};ShowFor.prototype.updateUI=function(){var persisted=null;var hash=document.location.hash;if(hash.indexOf(":")>=0){persisted=hash.slice(1)}if(persisted===null&&window.sessionStorage){persisted=sessionStorage.getItem("showfor::persist")}if(persisted){var itWorked=false;this.$container.find(".product input[type=checkbox]").prop("checked",false);persisted.split("&").forEach(function(prodInfo){var data=prodInfo.split(":");var product=data[0]||null;var platform=data[1]||null;var version=data[2]||null;var $product=this.$container.find('.product[data-product="'+product+'"]');if($product.length===0){return}itWorked=true;$product.find('input[type=checkbox][value="product:'+product+'"]').prop("checked",true);if(platform){var $platform=$product.find("select.platform");this.ensureSelect($platform,"platform",product,platform)}if(version){var $version=$product.find("select.version");this.ensureSelect($version,"version",product,version)}}.bind(this));if(itWorked){return}}var browser=this.productShortMap[BrowserDetect.browser]||BrowserDetect.browser;var platform=this.productShortMap[BrowserDetect.OS]||BrowserDetect.OS;var version=BrowserDetect.version;var $products=this.$container.find(".product");var productElems={};$products.each(function(i,elem){var $elem=$(elem);productElems[$elem.data("product")]=$elem});var verSlug,$version;if(version){if(browser==="firefox"&&this.productSlugs.indexOf("firefox")!==-1){verSlug="fx"+version;$version=productElems.firefox.find("select.version");this.ensureSelect($version,"version","firefox",verSlug)}else if(browser==="mobile"&&this.productSlugs.indexOf("mobile")!==-1){verSlug="m"+version;$version=productElems.mobile.find("select.version");this.ensureSelect($version,"version","mobile",verSlug)}else if(browser==="firefox-os"&&this.productSlugs.indexOf("firefox-os")!==-1){verSlug="fxos"+version.toFixed(1);$version=productElems["firefox-os"].find("select.version");this.ensureSelect($version,"version","firefox-os",verSlug)}}$products.find("select.platform").each(function(i,elem){var $elem=$(elem);var product=$elem.parents(".product").data("product");this.ensureSelect($elem,"platform",product,platform)}.bind(this))};ShowFor.prototype.onUIChange=function(){this.updateState();this.showAndHide();this.persist()};ShowFor.prototype.persist=function(){var key,val,i=0;var persisted="";for(key in this.state){val=this.state[key];if(val.enabled){if(i>0){persisted+="&"}var plat=val.platform||"";var ver=val.version?val.version.slug||"":"";persisted+=key+":"+plat+":"+ver;i++}}if(persisted===""){return}if(document.location.hash===""||document.location.hash.indexOf(":")>=0){history.replaceState(this.state,persisted,"#"+persisted)}if(window.sessionStorage){window.sessionStorage.setItem("showfor::persist",persisted)}};ShowFor.prototype.updateState=function(){this.state={};this.$container.find(".product").each(function(i,productElem){var $productElem=$(productElem);var slug=$productElem.data("product");this.state[slug]={enabled:$productElem.find("input[type=checkbox]").prop("checked")};$productElem.find("select").each(function(j,selectElem){var $selectElem=$(selectElem);var combined=$selectElem.val();var parts=combined.split(":");var type=parts[0];var data=parts[1];if(type==="version"){var $option=$selectElem.find("option:selected");data={slug:data,min:parseFloat($option.data("min")),max:parseFloat($option.data("max"))}}this.state[slug][type]=data}.bind(this))}.bind(this))};ShowFor.prototype.wrapTOCs=function(){this.$container.find("#toc a").each(function(i,elem){var $elem=$(elem);var idSelector=$elem.attr("href");if(idSelector[0]!=="#"){return}var $docSearcher=$(idSelector);var $wrappee=$elem.parent();while($docSearcher.length){if($docSearcher.hasClass("for")){var $wrapper=$("<span/>",{"class":"for","data-for":$docSearcher.data("for")});$wrappee=$wrappee.wrap($wrapper)}$docSearcher=$docSearcher.parent()}})};ShowFor.prototype.initShowFuncs=function(){this.$container.find(".for").each(function(i,elem){var $elem=$(elem);var showFor=$elem.data("for");var criteria=showFor.split(/\s*,\s*/);var showFunc=this.matchesCriteria.bind(this,criteria);$elem.data("show-func",showFunc)}.bind(this))};ShowFor.prototype.showAndHide=function(){this.$container.find(".for").each(function(i,elem){var $elem=$(elem);var showFunc=$elem.data("show-func");if(showFunc){$elem.toggle(showFunc())}else{$elem.show()}})};ShowFor.prototype.matchesCriteria=function(criteria){var hasProduct=false;var matchProduct=false;var hasPlatform=false;var matchPlatform=false;var enabledPlatforms=[];for(var slug in this.state){var prod=this.state[slug];if(prod.enabled&&prod.platform){enabledPlatforms.push(prod.platform)}}criteria.forEach(function(name){var productSlug,elemVersion;var not=name.indexOf("not")===0;if(not){name=name.replace(/^not ?/,"")}name=this.productShortMap[name]||name;var oper=">=";if(name[0]==="="){name=name.slice(1);oper="="}if(this.productSlugs.indexOf(name)>=0){hasProduct=true;if(this.state[name].enabled!==not){matchProduct=true}}else if(this.versionSlugs[name]!==undefined){productSlug=this.versionSlugs[name];hasProduct=true;elemVersion=parseFloat(/^[a-z]+([\d\.]+)$/.exec(name)[1]);var stateMin=this.state[productSlug].version.min;var stateMax=this.state[productSlug].version.max;var enabled=this.state[productSlug].enabled;var rightVersion=oper===">="&&elemVersion<stateMax||oper==="="&&elemVersion>=stateMin&&elemVersion<stateMax;if((enabled&&rightVersion)!==not){matchProduct=true}}else if(this.platformSlugs.indexOf(name)>=0){hasPlatform=true;if(enabledPlatforms.indexOf(name)>=0!==not){matchPlatform=true}}else if(name==="win"){hasPlatform=true;var windowsTypes=["winxp","win7","win8","win10"];var winMatches=false;windowsTypes.forEach(function(fakeName){if(enabledPlatforms.indexOf(fakeName)>=0){winMatches=true}});if(winMatches!==not){matchPlatform=true}}}.bind(this));return(!hasProduct||matchProduct)&&(!hasPlatform||matchPlatform)};window.ShowFor=ShowFor})(jQuery);(function($){"use strict";function AjaxVote(form,options){AjaxVote.prototype.init.call(this,form,options)}AjaxVote.prototype={init:function(form,options){var self=this,$ajaxForm=$(form),$btns=$ajaxForm.find('input[type="submit"], [data-type="submit"]');options=$.extend({positionMessage:false,removeForm:false,replaceFormWithMessage:false},options);self.options=options;self.voted=false;self.$form=$ajaxForm;$btns.click(function(e){if(!self.voted){var $btn=$(this),$form=$btn.closest("form"),url=$form.attr("action"),formDataArray=$form.serializeArray(),data={},i,l;$btns.attr("disabled","disabled");$form.addClass("busy");for(i=0,l=formDataArray.length;i<l;i++){data[formDataArray[i].name]=formDataArray[i].value}data[$btn.attr("name")]=$btn.val();$.ajax({url:url,type:"POST",data:data,dataType:"json",success:function(response){if(response.survey){self.showSurvey(response.survey,$form.parent())}if(response.message){self.showMessage(response.message,$btn,$form)}$btn.addClass("active");$btns.removeAttr("disabled");$form.removeClass("busy");self.voted=true;if(!data.ignored){$(document).trigger("vote",$.extend(data,{url:url}))}self.$form.filter(function(){return!$form.is(this)}).remove()},error:function(){var msg=gettext("There was an error submitting your vote.");self.showMessage(msg,$btn);$btns.removeAttr("disabled");$form.removeClass("busy")}})}$(this).blur();e.preventDefault();return false})},showMessage:function(message,$showAbove,$form){var self=this,$html=$('<div class="ajax-vote-box"><p class="msg"></p></div>'),offset=$showAbove.offset();$html.find("p").html(message);if(self.options.positionMessage){$("body").append($html);$html.css({top:offset.top-$html.height()-30,left:offset.left+$showAbove.width()/2-$html.width()/2});var timer=setTimeout(fadeOut,1e4);$("body").one("click",fadeOut)}else if(self.options.replaceFormWithMessage){$form.replaceWith($html.removeClass("ajax-vote-box"))}else{$showAbove.parent().parent().addClass($showAbove.val()).append($html)}function fadeOut(){$html.fadeOut(function(){$html.remove()});if(self.options.removeForm){self.$form.fadeOut(function(){self.$form.remove()})}$("body").unbind("click",fadeOut);clearTimeout(timer)}},showSurvey:function(survey,$container){var $survey=$(survey);var $commentCount=$survey.find("#remaining-characters");var $commentBox=$survey.find("textarea");var maxCount=parseInt($commentCount.text(),10);var $radios=$survey.find("input[type=radio][name=unhelpful-reason]");var $submit=$survey.find("input[type=submit], [data-type=submit]");var $reason=$survey.find(".disabled-reason");var $textbox=$survey.find("textarea");$container.after($survey);if($container.closest("aside").length){$container.remove()}$submit.prop("disabled",true);function validate(){var checked=$radios.filter(":checked").val();var feedback=$textbox.val();if(checked===undefined||(checked==="other"||checked==="firefox-feedback")&&!feedback){$submit.prop("disabled",true);$reason.fadeIn(600)}else{$submit.prop("disabled",false);$reason.fadeOut(600)}}$commentBox.bind("input",function(){var currentCount=$commentBox.val().length;var checked;if(maxCount-currentCount>=0){$commentCount.text(maxCount-currentCount)}else{$commentCount.text(0);$commentBox.val($commentBox.val().substr(0,maxCount))}validate()});$radios.bind("change",validate);new k.AjaxVote($survey.find("form"),{replaceFormWithMessage:true})}};window.k=window.k||{};window.k.AjaxVote=AjaxVote})(jQuery);(function($){"use strict";function AjaxPreview(el,options){AjaxPreview.prototype.init.call(this,el,options)}AjaxPreview.prototype={init:function(el,options){var self=this,$btn=$(el),o=options||{},previewUrl=o.previewUrl||$btn.data("preview-url"),$preview=o.previewElement&&$(o.previewElement)||$("#"+$btn.data("preview-container-id")),$content=o.contentElement&&$(o.contentElement)||$("#"+$btn.data("preview-content-id")),csrftoken=$btn.closest("form").find("input[name=csrfmiddlewaretoken]").val(),slug=$btn.closest("form").find("input[name=slug]").val(),locale=$btn.closest("form").find("input[name=locale]").val(),changeHash=o.changeHash===undefined?true:o.changeHash;$btn.click(function(e){e.preventDefault();$(this).attr("disabled","disabled");$(self).trigger("get-preview")});$(self).bind("get-preview",function(e){$.ajax({url:previewUrl,type:"POST",data:{content:$content.val(),slug:slug,locale:locale,csrfmiddlewaretoken:csrftoken},dataType:"html",success:function(html){$(self).trigger("show-preview",[true,html])},error:function(xhr,status,err){console.log(err);var msg=gettext("There was an error generating the preview.");$(self).trigger("show-preview",[false,msg])}})});$(self).bind("show-preview",function(e,success,html){$preview.html(html);if(changeHash){document.location.hash=$preview.attr("id")}$btn.removeAttr("disabled");$("img.lazy").loadnow();$(self).trigger("done",[success])})}};window.k=window.k||{};window.k.AjaxPreview=AjaxPreview})(jQuery);(function($){function init(){var $body=$("body");$("select.enable-if-js").removeAttr("disabled");initPrepopulatedSlugs();initDetailsTags();if($body.is(".document")){$("#support-search input[name=q]").val(k.unquote($.cookie("last_search")));new ShowFor;addReferrerAndQueryToVoteForm();new k.AjaxVote(".document-vote form",{positionMessage:true});initAOABanner()}else if($body.is(".review")){new ShowFor;initNeedsChange();$("img.lazy").loadnow();$("#actions input").removeAttr("disabled")}if($body.is(".edit, .new, .translate")){$("#id_comment").keypress(function(e){if(e.which===13){$(this).blur();$(this).closest("form").find("input[type=submit]").focus().click();return false}});initExitSupportFor();initArticlePreview();initPreviewDiff();initTitleAndSlugCheck();initPreValidation();initNeedsChange();initSummaryCount();initFormLock();initCodeMirrorEditor();$("img.lazy").loadnow();$(".submit input").removeAttr("disabled")}if($body.is(".edit, .new")){$(function(){$("#accordion").accordion({collapsible:true,heightStyle:"content",active:false})})}if($body.is(".translate")){initToggleDiff();initTranslationDraft()}initEditingTools();initDiffPicker();Marky.createFullToolbar(".editor-tools","#id_content");initReadyForL10n();initArticleApproveModal();initRevisionList();$("img.lazy").lazyload()}function initArticleApproveModal(){if($("#approve-modal").length>0){var onSignificanceClick=function(e){if(e.target.id==="id_significance_0"){$("#id_is_ready_for_localization").parent().hide()}else{$("#id_is_ready_for_localization").parent().show()}};$("#id_significance_0").click(onSignificanceClick);$("#id_significance_1").click(onSignificanceClick);$("#id_significance_2").click(onSignificanceClick)}}function initDetailsTags(){if(!("open"in document.createElement("details"))){document.documentElement.className+=" no-details"}if(!("open"in document.createElement("details"))){$("details").each(function(){var $details=$(this),$detailsSummary=$("summary",$details),$detailsNotSummary=$details.children(":not(summary)"),$detailsNotSummaryContents=$details.contents(":not(summary)");if(!$detailsSummary.length){$detailsSummary=$(document.createElement("summary")).text("Details").prependTo($details)}if($detailsNotSummary.length!==$detailsNotSummaryContents.length){$detailsNotSummaryContents.filter(function(){return this.nodeType===3&&/[^\t\n\r ]/.test(this.data)}).wrap("<span>");$detailsNotSummary=$details.children(":not(summary)")}if(typeof $details.attr("open")!=="undefined"){$details.addClass("open");$detailsNotSummary.show()}else{$detailsNotSummary.hide()}$detailsSummary.attr("tabindex",0).click(function(){$detailsSummary.focus();if(typeof $details.attr("open")!=="undefined"){$details.removeAttr("open")}else{$details.attr("open","open")}$detailsNotSummary.slideToggle();$details.toggleClass("open")}).keyup(function(event){if(event.keyCode===13||event.keyCode===32){if(!($.browser.opera&&event.keyCode===13)){event.preventDefault();$detailsSummary.click()}}})})}}function detectBrowser(){function getVersionGroup(browser,version){if(browser===undefined||version===undefined||!VERSIONS[browser]){return undefined}for(var i=0;i<VERSIONS[browser].length;i++){if(version<VERSIONS[browser][i][0]){return browser+VERSIONS[browser][i][1]}}}return getVersionGroup(BrowserDetect.browser,BrowserDetect.version)}function initPrepopulatedSlugs(){var fields={title:{id:"#id_slug",dependency_ids:["#id_title"],dependency_list:["#id_title"],maxLength:50}};$.each(fields,function(i,field){$(field.id).addClass("prepopulated_field");$(field.id).data("dependency_list",field.dependency_list).prepopulate($(field.dependency_ids.join(",")),field.maxLength)})}function initSummaryCount(){var $summaryCount=$("#remaining-characters"),$summaryBox=$("#id_summary"),warningCount=160,maxCount=$summaryCount.text(),updateCount=function(){var currentCount=$summaryBox.val().length;$summaryCount.text(warningCount-currentCount);if(warningCount-currentCount>=0){$summaryCount.css("color","black")}else{$summaryCount.css("color","red");if(currentCount>=maxCount){$summaryBox.val($summaryBox.val().substr(0,maxCount))}}};updateCount();$summaryBox.bind("input",updateCount)}function initArticlePreview(){var $preview=$("#preview"),$previewBottom=$("#preview-bottom"),preview=new k.AjaxPreview($(".btn-preview"),{contentElement:$("#id_content"),previewElement:$preview});$(preview).bind("done",function(e,success){if(success){$previewBottom.show();new ShowFor;$preview.find("select.enable-if-js").removeAttr("disabled");$preview.find(".kbox").kbox();$("#preview-diff .output").empty()}})}function initPreviewDiff(){var $diff=$("#preview-diff"),$previewBottom=$("#preview-bottom"),$diffButton=$(".btn-diff");$diff.addClass("diff-this");$diffButton.click(function(){$diff.find(".to").text($("#id_content").val());k.initDiff($diff.parent());$previewBottom.show();$("#preview").empty()})}function initTitleAndSlugCheck(){$("#id_title").change(function(){var $this=$(this),$form=$this.closest("form"),title=$this.val(),slug=$("#id_slug").val();verifyTitleUnique(title,$form);verifySlugUnique(slug,$form)});$("#id_slug").change(function(){var $this=$(this),$form=$this.closest("form"),slug=$("#id_slug").val();verifySlugUnique(slug,$form)});function verifyTitleUnique(title,$form){var errorMsg=gettext("A document with this title already exists in this locale.");verifyUnique("title",title,$("#id_title"),$form,errorMsg)}function verifySlugUnique(slug,$form){var errorMsg=gettext("A document with this slug already exists in this locale.");verifyUnique("slug",slug,$("#id_slug"),$form,errorMsg)}function verifyUnique(fieldname,value,$field,$form,errorMsg){$field.removeClass("error");$field.parent().find("ul.errorlist").remove();var data={};data[fieldname]=value;$.ajax({url:$form.data("json-url"),type:"GET",data:data,dataType:"json",success:function(json){var docId=$form.data("document-id");if(!docId||json.id&&json.id!==parseInt(docId)){$field.addClass("error");$field.before($('<ul class="errorlist"><li/></ul>').find("li").text(errorMsg).end())}},error:function(xhr,error){if(xhr.status===405){}else{}}})}}function initAOABanner(){var $banner=$("#banner"),cssFrom={top:-100},cssTo={top:-10};if($banner.length>0){setTimeout(function(){$banner.css({
display:"block"}).css(cssFrom).animate(cssTo,500).find("a.close").click(function(e){e.preventDefault();$banner.animate(cssFrom,500,"swing",function(){$banner.css({display:"none"})})})},500)}}function initPreValidation(){var $modal=$("#submit-modal"),kbox=$modal.data("kbox");kbox.updateOptions({preOpen:function(){var form=$(".btn-submit").closest("form")[0];if(form.checkValidity&&!form.checkValidity()){$modal.find('button[type="submit"]').click();return false}$modal.find("#id_comment").attr("required",true);return true},preClose:function(){$modal.find("#id_comment").removeAttr("required");return true}})}function initDiffPicker(){$("div.revision-diff").each(function(){var $diff=$(this);$diff.find("div.picker a").unbind().click(function(ev){ev.preventDefault();$.ajax({url:$(this).attr("href"),type:"GET",dataType:"html",success:function(html){var kbox=new KBox(html,{modal:true,id:"diff-picker-kbox",closeOnOutClick:true,destroy:true,title:gettext("Choose revisions to compare")});kbox.open();ajaxifyDiffPicker(kbox.$kbox.find("form"),kbox,$diff)},error:function(){var message=gettext("There was an error.");alert(message)}})})})}function ajaxifyDiffPicker($form,kbox,$diff){$form.submit(function(ev){ev.preventDefault();$.ajax({url:$form.attr("action"),type:"GET",data:$form.serialize(),dataType:"html",success:function(html){var $container=$diff.parent();kbox.close();$diff.replaceWith(html);initDiffPicker();k.initDiff()}})})}function initReadyForL10n(){var $watchDiv=$("#revision-list div.l10n"),post_url,checkbox_id;$watchDiv.find("a.markasready").click(function(){var $check=$(this);post_url=$check.data("url");checkbox_id=$check.attr("id");$("#ready-for-l10n-modal span.revtime").html("("+$check.data("revdate")+")")});$("#ready-for-l10n-modal input[type=submit], #ready-for-l10n-modal button[type=submit]").click(function(){var csrf=$("#ready-for-l10n-modal input[name=csrfmiddlewaretoken]").val(),kbox=$("#ready-for-l10n-modal").data("kbox");if(post_url!==undefined&&checkbox_id!==undefined){$.ajax({type:"POST",url:post_url,data:{csrfmiddlewaretoken:csrf},success:function(response){$("#"+checkbox_id).removeClass("markasready").addClass("yes");$("#"+checkbox_id).unbind("click");kbox.close()},error:function(){kbox.close()}})}})}function addReferrerAndQueryToVoteForm(){var urlParams=k.getQueryParamsAsDict(),referrer=k.getReferrer(urlParams),query=k.getSearchQuery(urlParams,referrer);$(".document-vote form").append($('<input type="hidden" name="referrer"/>').attr("value",referrer)).append($('<input type="hidden" name="query"/>').attr("value",query))}function initNeedsChange(){var $checkbox=$("#id_needs_change"),$comment=$("#document-form li.comment,#approve-modal div.comment");if($checkbox.length>0){updateComment();$checkbox.change(updateComment)}function updateComment(){if($checkbox.is(":checked")){$comment.slideDown();$comment.find("textarea").attr("required","required")}else{$comment.hide();$comment.find("textarea").removeAttr("required")}}}function watchDiscussion(){$(".watch-form").click(function(){var form=$(this);$.post(form.attr("action"),form.serialize(),function(){form.find(".watchtoggle").toggleClass("on")}).error(function(){});return false})}function initEditingTools(){$("#quick-links .edit a").click(function(ev){ev.preventDefault();$("#doc-tabs").slideToggle("fast",function(){$("body").toggleClass("show-editing-tools")});if($(this).is(".show")){$.cookie("show-editing-tools",1,{path:"/"})}else{$.cookie("show-editing-tools",null,{path:"/"})}})}function initCodeMirrorEditor(){window.codemirror=true;window.highlighting={};var editor=$("<div id='editor'></div>");var editor_wrapper=$("<div id='editor_wrapper'></div>");var updateHighlightingEditor=function(){var currentEditor=window.highlighting.editor;if(!currentEditor){return}var content=$("#id_content").val();currentEditor.setValue(content)};window.highlighting.updateEditor=updateHighlightingEditor;var switch_link=$("<a></a>").text(gettext("Toggle syntax highlighting")).css({cssFloat:"right",cursor:"pointer"}).toggle(function(){editor_wrapper.css("display","none");$("#id_content").css("display","block")},function(){updateHighlightingEditor();editor_wrapper.css("display","block");$("#id_content").css("display","none")});var highlightingEnabled=function(){return editor_wrapper.css("display")==="block"};window.highlighting.isEnabled=highlightingEnabled;editor_wrapper.append(editor);$("#id_content").after(switch_link).after(editor_wrapper).hide();window.addEventListener("load",function(){var cm_editor=CodeMirror(document.getElementById("editor"),{mode:{name:"sumo"},value:$("#id_content").val(),lineNumbers:true,lineWrapping:true,extraKeys:{"Ctrl-Space":"autocomplete"}});window.highlighting.editor=cm_editor;$("#id_content").bind("keyup",updateHighlightingEditor);updateHighlightingEditor();cm_editor.on("change",function(e){if(!highlightingEnabled()){return}$("#id_content").val(cm_editor.getValue())})},false)}function initFormLock(){var $doc=$("#edit-document");if(!$doc.length){$doc=$("#localize-document")}if($doc.is(".locked")){var $inputs=$doc.find("input:enabled, textarea:enabled").prop("disabled",true)}$("#unlock-button").on("click",function(){$inputs.prop("disabled",false);$doc.removeClass("locked");$("#locked-warning").slideUp(500);var doc_slug=$doc.data("slug");var url=window.location.toString();url=url.replace(/edit/,"steal_lock");$.ajax({url:url})})}function initToggleDiff(){var $diff=$("#content-diff");var $contentOrDiff=$("#content-or-diff");if($diff.length>0){$contentOrDiff.append($diff.clone()).append($("<a/>").text(gettext("Toggle Diff")).click(function(e){e.preventDefault();$contentOrDiff.toggleClass("content diff")}))}}function initTranslationDraft(){var $draftButton=$(".btn-draft"),url=$(".btn-draft").data("draft-url"),$draftMessage=$("#draft-message");$draftButton.click(function(){var message=gettext("<strong>Draft is saving...</strong>"),image='<img src="/static/sumo/img/customercare/spinner.gif">',bothData=$("#both_form").serializeArray(),docData=$("#doc_form").serializeArray(),revData=$("#rev_form").serializeArray(),totalData=$.extend(bothData,docData,revData);$draftMessage.html(image+message).removeClass("success error").addClass("info").show();$.post(url,totalData).done(function(){var time=new Date,message=interpolate(gettext("<strong>Draft has been saved on:</strong> %s"),[time]);$draftMessage.html(message).toggleClass("info success").show()}).fail(function(){var message=gettext("<strong>Error saving draft</strong>");$draftMessage.html(message).toggleClass("info error").show()})})}function initRevisionList(){var $form=$("#revision-list form.filter");if(!$form.length){return}function updateRevisionList(query){if(query===undefined){query=$form.serialize()}if(query.charAt(0)!=="?"){query="?"+query}var url=$form.attr("action")+query;var scrollPos=Math.min($(document).scrollTop(),$("#revision-list").offset().top);$(document).scrollTop(scrollPos);history.replaceState({},"",url);$("#revisions-fragment").css("opacity",0);$.get(url+"&fragment=1",function(data){$(".loading").hide();$("#revisions-fragment").html(data).css("opacity",1)})}var timeout;$form.on("change keyup","input, select",function(){$(".loading").show();clearTimeout(timeout);timeout=setTimeout(updateRevisionList,200)});$("#revision-list").on("click",".pagination a",function(){var query=$(this)[0].search;updateRevisionList(query);return false});$("#revision-list").on("click",".show-diff",function(){var $this=$(this);$this.hide();$this.parent().find(".loading").show();var $diffView=$('<div class="diff-view">').hide().appendTo($(this).parents("li").first());var url=$this.attr("href");$.get(url,function(html){$diffView.html(html);$diffView.find(".picker").html('<a href="" class="close-diff">Close diff</a>');$diffView.slideDown();$this.parent().find(".close-diff").show();$this.parent().find(".loading").hide();k.initDiff()});return false});$("#revision-list").on("click",".close-diff",function(){var $row=$(this).parents("li").first();$row.find(".diff-view").slideUp(400,function(){$row.find(".show-diff").show();$row.find(".close-diff").hide();$row.find(".diff-view").remove()});return false});$form.find(".btn, .button").remove();$form.on("keydown",function(e){if(e.which===13){return false}});$form.find("input[type=date]").datepicker()}$(document).ready(init);window.k.makeWikiCollapsable=function(){$("#toc").hide();$("#doc-content h1").each(function(){var $this=$(this);var $siblings=$(this).nextAll();var sectionElems=[];$siblings.each(function(){if($(this).is("h1")){return false}sectionElems.push(this)});var $foldingSection=$("<div />");$foldingSection.addClass("wiki-section").addClass("collapsed");$this.before($foldingSection);$foldingSection.append($this);var $section=$("<section />");$foldingSection.append($section);for(var i=0;i<sectionElems.length;i++){$section.append(sectionElems[i])}});$("#doc-content").on("click","h1",function(){$(this).closest(".wiki-section").toggleClass("collapsed")});$(window.location.hash).closest(".wiki-section").removeClass("collapsed")};if($("#doc-content").is(".collapsible")){k.makeWikiCollapsable()}function initExitSupportFor(){$("#support-for-exit").live("click",function(){$("#support-for").remove()})}})(jQuery);(function($){function init(){initVocab();initTagAdding();initAutoComplete();initTagRemoval()}function initVocab(){$("div.tags[data-tag-vocab-json]").each(function(){var $tagContainer=$(this);var parsedVocab=$tagContainer.data("tag-vocab-json");$tagContainer.data("tagVocab",_.keys(parsedVocab))})}function initAutoComplete(){function makeButtonTender($addForm){var $adder=$addForm.find("input.adder"),$input=$addForm.find("input.autocomplete-tags"),$tagsDiv=$input.closest("div.tags"),canCreateTags=$tagsDiv.data("can-create-tags")!==undefined,vocab=$tagsDiv.data("tagVocab"),$tagList=inputToTagList($input);function tendAddButton(){var tagName=$.trim($input.val()),inVocab=inArrayCaseInsensitive(tagName,vocab)!==-1,isOnscreen=tagIsOnscreen(tagName,$tagList);$adder.attr("disabled",!tagName.length||isOnscreen||!canCreateTags&&!inVocab)}return tendAddButton}function makeVocabCallback($tags){var vocab=$tags.data("tagVocab"),$tagList=$tags.find("ul.tag-list");function vocabCallback(request,response){var appliedTags=getAppliedTags($tagList),vocabMinusApplied=$.grep(vocab,function(e,i){return $.inArray(e,appliedTags)===-1});response(filter(vocabMinusApplied,request.term))}return vocabCallback}$("input.autocomplete-tags").each(function(){var $input=$(this),tender=makeButtonTender($input.closest("form"));$input.autocomplete({source:makeVocabCallback($input.closest("div.tags")),delay:0,minLength:1,close:tender});$input.keyup(tender);$input.bind("autocompletechange",tender)})}function initTagRemoval(){$("div.tags").each(function(){var $div=$(this),async=!$div.hasClass("deferred");$div.find(".tag").each(function(){attachRemoverHandlerTo($(this),async)})});$("form.remove-tag-form").submit(function(){return false})}function attachRemoverHandlerTo($container,async){$container.find(".remover").click(function(){var $remover=$(this),$tag=$remover.closest(".tag"),tagName=$tag.find(".tag-name").text(),csrf=$remover.closest("form").find("input[name=csrfmiddlewaretoken]").val();function makeTagDisappear(){$tag.remove()}if(async){$tag.addClass("in-progress");$.ajax({type:"POST",url:$remover.closest("form.remove-tag-form").data("action-async"),data:{name:tagName,csrfmiddlewaretoken:csrf},success:makeTagDisappear,error:function makeTagReappear(){$tag.removeClass("in-progress")}})}else{makeTagDisappear()}return false})}function addTag($container,async){var $input=$container.find("input.autocomplete-tags"),tagName=$input.val(),vocab=$input.closest("div.tags").data("tagVocab"),tagIndex=inArrayCaseInsensitive(tagName,vocab),csrf=$container.find("input[name=csrfmiddlewaretoken]").val(),$tag;function putTagOnscreen(name){var $tagList=inputToTagList($input);if(!tagIsOnscreen(name,$tagList)){var $li=$("<li class='tag'><span class='tag-name' /><input type='submit' value='&#x2716;' class='remover' /></li> ");if(async){$li.addClass("in-progress")}else{var $hidden=$("<input type='hidden' />");$hidden.attr("value",name);$hidden.attr("name",$input.attr("name"));$li.prepend($hidden);attachRemoverHandlerTo($li,false)}$li.find(".tag-name").text(name);$li.find("input.remover").attr("name","remove-tag-"+name);$tagList.append($li);return $li}}if(tagIndex===-1){if(async){vocab.push(tagName)}}else{tagName=vocab[tagIndex]}$tag=putTagOnscreen(tagName);if($tag&&async){$.ajax({type:"POST",url:$container.data("action-async"),data:{"tag-name":tagName,csrfmiddlewaretoken:csrf},success:function solidifyTag(data){var url=data.tagUrl,tagNameSpan=$tag.find(".tag-name");tagNameSpan.replaceWith($("<a class='tag-name' />").attr("href",url).text(tagNameSpan.text()));$tag.removeClass("in-progress");attachRemoverHandlerTo($tag,true)},error:function disintegrateTag(data){$tag.remove()}})}$input.val("");$container.find("input.adder").attr("disabled",true);return false}function initTagAdding(){$("div.tags input.adder:enabled").attr("disabled",true);$(".tag-adder").each(function(){var $this=$(this),async=!$this.hasClass("deferred");function handler(){return addTag($this,async)}if($this.is("form")){$this.submit(handler)}else{$this.find("input.adder").click(handler)}})}function inputToTagList($input){return $input.closest("div.tags").find("ul.tag-list")}function escapeRegex(value){return value.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")}function filter(array,term){var matcher=new RegExp(escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}function inArrayCaseInsensitive(str,ary){var matcher=new RegExp("^"+escapeRegex(str)+"$","i");for(var i=0;i<ary.length;i++){if(matcher.test(ary[i])){return i}}return-1}function getAppliedTags($tagList){var tagNames=[];$tagList.find(".tag .tag-name").each(function(i,e){tagNames.push($(e).text())});return tagNames}function tagIsOnscreen(tagName,$tagList){return inArrayCaseInsensitive(tagName,getAppliedTags($tagList))!==-1}$(document).ready(init)})(jQuery);(function($){function init(){initReadoutModes();initWatchMenu();initNeedsChange();initAnnouncements();initL10nStringsStats()}function initReadoutModes(){$(".readout-modes").each(function attachClickHandler(){var $modes=$(this),slug=$modes.attr("data-slug");$modes.find(".mode").each(function(){var $button=$(this);$button.click(function switchMode(){var $table=$("#"+slug+"-table");$table.addClass("busy");$modes.find(".mode").removeClass("active");$button.addClass("active");$.get($button.attr("data-url"),function succeed(html){$table.html(html).removeClass("busy")});return false})})})}function initWatchMenu(){var $watchDiv=$("#doc-watch"),$menu=$watchDiv.find(".popup-menu");$watchDiv.find(".popup-trigger").click(function toggleMenu(){$menu.toggle()});$watchDiv.find("input[type=checkbox]").click(function post(){var $box=$(this),csrf=$box.closest("form").find("input[name=csrfmiddlewaretoken]").val(),isChecked=$box.attr("checked");$box.attr("disabled","disabled");$.ajax({type:"POST",url:isChecked?$box.data("action-watch"):$box.data("action-unwatch"),data:{csrfmiddlewaretoken:csrf},success:function(){$box.attr("disabled","")},error:function(){$box.attr("checked",isChecked?"":"checked").attr("disabled","")}})})}function initNeedsChange(){$("#need-changes-table tr").click(function(e){if(!$(e.target).is("a")){$(this).toggleClass("active")}})}function initAnnouncements(){var $form=$("#create-announcement form");$form.find("button.btn-submit").on("click",function(ev){ev.preventDefault();var $kbox=$("#create-announcement .kbox");$form.addClass("wait");$form.find(".error").remove();$.ajax({type:"POST",url:$form.prop("action"),data:$form.serialize(),statusCode:{200:function(data){$form.removeClass("wait");$kbox.hide(200,function(){$kbox.data("kbox").close();$kbox.show()});var $success=$("#create-announcement").children(".success").show().css({opacity:1});setTimeout(function(){$success.animate({opacity:0},1e3)},4e3)},400:function(jxr){var data,field;$form.removeClass("wait");try{data=JSON.parse(jxr.responseText)}catch(e){data={}}for(field in data){$form.find("[name="+field+"]").parent().after('<li class="error">'+data[field]+"</li>")}}}})});$(".announcements li a.delete").on("click",function(ev){ev.preventDefault();var $this=$(this);$.ajax({type:"POST",url:$this.prop("href"),data:{csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(){$this.closest("li").remove()}})})}function initL10nStringsStats(){var $tr=$("tr.ui-strings-row");var $tds=$tr.find("td");var now=new Date;var cacheBust=now.getYear().toString()+now.getMonth().toString()+now.getDay().toString();if($tr.length===0){return}$.getJSON("/media/uploads/l10n_summary.json?_cache="+cacheBust,function(data){var localeData=data.locales[$("html").attr("lang")];var className="bad";$($tds[1]).html(interpolate(gettext("%(num)s <small>of %(total)s</small>"),{num:localeData.translated,total:localeData.total},true));if(localeData.percent>=20){className="better"}if(localeData.percent===100){className="best"}$($tds[2]).html(interpolate("%(percent)s% "+'<div class="percent-graph">'+'<div style="width: %(percent)s%" class="%(className)s">'+"</div>"+"</div>",{percent:localeData.percent,className:className},true))})}$(document).ready(init)})(jQuery);(function($){"use strict";function initInlineEditing(){$(".editable a.edit").each(function(){var $this=$(this),originalText=$this.text();$this.click(function(ev){var $container=$this.closest(".editable");$container.toggleClass("edit-on");if($container.hasClass("edit-on")){$this.text(gettext("Cancel"))}else{$this.text(originalText)}ev.preventDefault()})})}$(document).ready(initInlineEditing)})(jQuery);(function($){function init(){if(!$("body").is(".document")){return}$(document).on("vote",function(t,data){var value;if(_gaq){if("helpful"in data){value="Helpful"}else if("not-helpful"in data){value="Not Helpful"}else{return}trackEvent("Article Vote",data.source+" - "+value,getEnglishSlug()+" / "+getLocale())}});$("#os").change(function(){trackEvent("ShowFor Switch","OS - "+$(this).val(),getEnglishSlug()+" / "+getLocale())});$("#browser").change(function(){trackEvent("ShowFor Switch","Version - "+$(this).val(),getEnglishSlug()+" / "+getLocale())});setTimeout(function(){trackEvent("Article Read",getEnglishSlug()+" / "+getLocale())},1e4);function getLocale(){return $("html").attr("lang")}function getEnglishSlug(){return $("body").data("default-slug")}}$(document).ready(init)})(jQuery);(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["macros.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{var macro_t_1=runtime.makeMacro(["result"],[],function(l_result,kwargs){frame=frame.push();kwargs=kwargs||{};if(kwargs.hasOwnProperty("caller")){frame.set("caller",kwargs.caller)}frame.set("result",l_result);var t_2="";t_2+='\n  <div class="result ';t_2+=runtime.suppressValue(runtime.memberLookup(l_result,"type",env.opts.autoescape),env.opts.autoescape);t_2+='">\n    <h3><a class="title" href="';t_2+=runtime.suppressValue(runtime.memberLookup(l_result,"url",env.opts.autoescape),env.opts.autoescape);t_2+='" data-event-category="Instant Search" data-event-action="Result Clicked">';t_2+=runtime.suppressValue(runtime.memberLookup(l_result,"title",env.opts.autoescape),env.opts.autoescape);t_2+="</a></h3>\n    ";if(runtime.memberLookup(l_result,"type",env.opts.autoescape)=="question"){t_2+='\n      <ul class="thread-meta cf">\n        ';if(runtime.memberLookup(l_result,"is_solved",env.opts.autoescape)){t_2+="\n          <li>";t_2+=runtime.suppressValue((lineno=6,colno=16,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Solved"])),env.opts.autoescape);t_2+="</li>\n        "}t_2+="\n        <li>\n          ";if(runtime.memberLookup(l_result,"num_answers",env.opts.autoescape)>0){t_2+="\n            ";t_2+=runtime.suppressValue(env.getFilter("f").call(context,(lineno=10,colno=21,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"ngettext"),"ngettext",["1 reply","%s replies",runtime.memberLookup(l_result,"num_answers",env.opts.autoescape)])),[runtime.memberLookup(l_result,"num_answers",env.opts.autoescape)]),env.opts.autoescape);t_2+="\n          "}else{t_2+="\n            ";t_2+=runtime.suppressValue((lineno=12,colno=14,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["No replies"])),env.opts.autoescape);t_2+="\n          "}t_2+="\n        </li>\n        <li>\n          ";t_2+=runtime.suppressValue(env.getFilter("f").call(context,(lineno=16,colno=19,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"ngettext"),"ngettext",["1 person has this problem","%s people have this problem",runtime.memberLookup(l_result,"num_votes",env.opts.autoescape)])),[runtime.memberLookup(l_result,"num_votes",env.opts.autoescape)]),env.opts.autoescape);t_2+="\n        </li>\n        <li>\n          ";t_2+=runtime.suppressValue(env.getFilter("f").call(context,(lineno=19,colno=19,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"ngettext"),"ngettext",["1 new this week","%s new this week",runtime.memberLookup(l_result,"num_votes_past_week",env.opts.autoescape)])),[runtime.memberLookup(l_result,"num_votes_past_week",env.opts.autoescape)]),env.opts.autoescape);t_2+="\n        </li>\n      </ul>\n    "}t_2+='\n    <a tabindex="-1" href="';t_2+=runtime.suppressValue(runtime.memberLookup(l_result,"url",env.opts.autoescape),env.opts.autoescape);t_2+='" data-event-category="Instant Search" data-event-action="Result Clicked">';t_2+=runtime.suppressValue(env.getFilter("safe").call(context,runtime.memberLookup(l_result,"search_summary",env.opts.autoescape)),env.opts.autoescape);t_2+="</a>\n  </div>\n";frame=frame.pop();return new runtime.SafeString(t_2)});context.addExport("search_result");context.setVariable("search_result",macro_t_1);output+="\n";cb(null,output)}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["mobile-product-search-results.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{output+='<div class="search-header">';output+=runtime.suppressValue((lineno=0,colno=29,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Search results"])),env.opts.autoescape);output+='</div>\n<ul class="document-list">\n  ';if(runtime.contextOrFrameLookup(context,frame,"num_results")>0){output+="\n    ";frame=frame.push();var t_3=runtime.contextOrFrameLookup(context,frame,"results");if(t_3){var t_2=t_3.length;for(var t_1=0;t_1<t_3.length;t_1++){var t_4=t_3[t_1];frame.set("doc",t_4);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+='\n      <li>\n        <a href="';output+=runtime.suppressValue(runtime.memberLookup(t_4,"url",env.opts.autoescape),env.opts.autoescape);output+='">';output+=runtime.suppressValue(runtime.memberLookup(t_4,"title",env.opts.autoescape),env.opts.autoescape);output+="</a>\n      </li>\n    "}}frame=frame.pop();output+="\n  "}else{output+='\n    <li><a href="#">';output+=runtime.suppressValue((lineno=9,colno=22,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["No results found."])),env.opts.autoescape);output+="</a></li>\n  "}output+="\n</ul>\n";cb(null,output)}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["mobile-search-results.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{if(runtime.contextOrFrameLookup(context,frame,"results")){output+='\n  <ol class="search-results">\n    ';frame=frame.push();var t_3=runtime.contextOrFrameLookup(context,frame,"results");if(t_3){var t_2=t_3.length;for(var t_1=0;t_1<t_3.length;t_1++){var t_4=t_3[t_1];frame.set("doc",t_4);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+='\n      <li class="';output+=runtime.suppressValue(runtime.memberLookup(t_4,"type",env.opts.autoescape),env.opts.autoescape);output+='">\n        <a href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,env.getFilter("urlparams").call(context,runtime.memberLookup(t_4,"url",env.opts.autoescape),runtime.makeKeywordArgs({s:runtime.contextOrFrameLookup(context,frame,"q"),as:"s"}))),env.opts.autoescape);output+='">\n          <span class="title">';output+=runtime.suppressValue(runtime.memberLookup(t_4,"title",env.opts.autoescape),env.opts.autoescape);output+="</span>\n          ";output+=runtime.suppressValue(env.getFilter("safe").call(context,runtime.memberLookup(t_4,"search_summary",env.opts.autoescape)),env.opts.autoescape);output+="\n        </a>\n      </li>\n    "}}frame=frame.pop();output+="\n  </ol>\n"}else{output+="\n  ";output+=runtime.suppressValue((lineno=12,colno=4,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["No results found"])),env.opts.autoescape);output+="\n"}output+="\n";cb(null,output)}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["search-results-list.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{env.getTemplate("macros.html",false,"search-results-list.html",function(t_2,t_1){if(t_2){cb(t_2);return}t_1.getExported(function(t_3,t_1){if(t_3){cb(t_3);return}if(t_1.hasOwnProperty("search_result")){var t_4=t_1.search_result}else{cb(new Error("cannot import 'search_result'"));return}context.setVariable("search_result",t_4);output+="\n\n";if(runtime.contextOrFrameLookup(context,frame,"num_results")>0){output+="\n  <h2>\n    ";output+="\n    ";output+=runtime.suppressValue(env.getFilter("safe").call(context,env.getFilter("f").call(context,(lineno=5,colno=13,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"ngettext"),"ngettext",["Found <strong>%(n)s</strong> result for <strong>%(q)s</strong> for <strong>%(product)s</strong>","Found <strong>%(n)s</strong> results for <strong>%(q)s</strong> for <strong>%(product)s</strong>",runtime.contextOrFrameLookup(context,frame,"num_results")])),{n:runtime.contextOrFrameLookup(context,frame,"num_results"),q:runtime.contextOrFrameLookup(context,frame,"q"),product:runtime.contextOrFrameLookup(context,frame,"product_titles")},true)),env.opts.autoescape);output+='\n  </h2>\n\n  <ul id="doctype-filter" class="search-filter cf">\n    <li ';output+=runtime.suppressValue(env.getFilter("class_selected").call(context,runtime.contextOrFrameLookup(context,frame,"w"),3),env.opts.autoescape);output+='>\n      <a href="#" data-instant-search-set-params="w=3" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,runtime.contextOrFrameLookup(context,frame,"base_doctype_url")),env.opts.autoescape);output+='">\n        <img alt="copy" class="show-everything" src="/static/sumo/img/icon-copy.png"/>\n        ';output+=runtime.suppressValue((lineno=16,colno=10,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Show Everything"])),env.opts.autoescape);output+="\n      </a>\n    </li>\n    <li ";output+=runtime.suppressValue(env.getFilter("class_selected").call(context,runtime.contextOrFrameLookup(context,frame,"w"),1),env.opts.autoescape);output+='>\n      <a href="#" data-instant-search-set-params="w=1" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_doctype_url"),runtime.makeKeywordArgs({w:1}))),env.opts.autoescape);output+='">\n        <img alt="file" class="help-articles" src="/static/sumo/img/icon-file.png"/>\n        ';output+=runtime.suppressValue((lineno=22,colno=10,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Help Articles Only"])),env.opts.autoescape);output+="\n      </a>\n    </li>\n    <li ";output+=runtime.suppressValue(env.getFilter("class_selected").call(context,runtime.contextOrFrameLookup(context,frame,"w"),2),env.opts.autoescape);output+='>\n      <a href="#" data-instant-search-set-params="w=2" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_doctype_url"),runtime.makeKeywordArgs({w:2}))),env.opts.autoescape);output+='">\n        <img alt="discuss" class="community-discussion" src="/static/sumo/img/icon-discuss.png"/>\n        ';output+=runtime.suppressValue((lineno=28,colno=10,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Community Discussion Only"])),env.opts.autoescape);output+='\n      </a>\n    </li>\n  </ul>\n\n  <div class="content-box">\n    ';frame=frame.push();var t_7=runtime.contextOrFrameLookup(context,frame,"results");if(t_7){var t_6=t_7.length;for(var t_5=0;t_5<t_7.length;t_5++){var t_8=t_7[t_5];frame.set("doc",t_8);frame.set("loop.index",t_5+1);frame.set("loop.index0",t_5);frame.set("loop.revindex",t_6-t_5);frame.set("loop.revindex0",t_6-t_5-1);frame.set("loop.first",t_5===0);frame.set("loop.last",t_5===t_6-1);frame.set("loop.length",t_6);output+="\n      ";output+=runtime.suppressValue((lineno=35,colno=20,runtime.callWrap(t_4,"search_result",[t_8])),env.opts.autoescape);output+="\n    "}}frame=frame.pop();output+="\n  </div>\n"}else{output+="\n  <h2>\n    ";output+="\n    ";output+=runtime.suppressValue(env.getFilter("safe").call(context,env.getFilter("f").call(context,(lineno=41,colno=6,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["We couldn't find any results for <strong>%(q)s</strong> in <strong>%(l)s</strong>. Maybe one of these articles will be helpful?"])),{q:runtime.contextOrFrameLookup(context,frame,"q"),l:runtime.contextOrFrameLookup(context,frame,"lang_name")},true)),env.opts.autoescape);output+='\n  </h2>\n\n  <div class="content-box">\n    ';frame=frame.push();var t_11=runtime.contextOrFrameLookup(context,frame,"fallback_results");if(t_11){var t_10=t_11.length;for(var t_9=0;t_9<t_11.length;t_9++){var t_12=t_11[t_9];frame.set("doc",t_12);frame.set("loop.index",t_9+1);frame.set("loop.index0",t_9);frame.set("loop.revindex",t_10-t_9);frame.set("loop.revindex0",t_10-t_9-1);frame.set("loop.first",t_9===0);frame.set("loop.last",t_9===t_10-1);frame.set("loop.length",t_10);output+='\n      <div class="result document">\n        <h3><a class="title" href="';output+=runtime.suppressValue(runtime.memberLookup(t_12,"url",env.opts.autoescape),env.opts.autoescape);output+='">';output+=runtime.suppressValue(runtime.memberLookup(t_12,"document_title",env.opts.autoescape),env.opts.autoescape);output+='</a></h3>\n        <a tabindex="-1" href="';output+=runtime.suppressValue(runtime.memberLookup(t_12,"url",env.opts.autoescape),env.opts.autoescape);output+='">';output+=runtime.suppressValue(runtime.memberLookup(t_12,"document_summary",env.opts.autoescape),env.opts.autoescape);output+="</a>\n      </div>\n    "}}frame=frame.pop();output+="\n  </div>\n"}output+="\n\n";if(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"num_pages",env.opts.autoescape)>1){output+='\n  <ol class="pagination cf">\n  ';if(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"has_previous",env.opts.autoescape)){output+='\n    <li class="prev">\n      <a class="btn-page btn-page-prev" href="#" data-instant-search="link" data-href="';
output+=runtime.suppressValue(env.getFilter("urlparams").call(context,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"url",env.opts.autoescape),{page:runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"number",env.opts.autoescape)-1}),env.opts.autoescape);output+='">\n        ';output+=runtime.suppressValue((lineno=61,colno=10,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Previous"])),env.opts.autoescape);output+="\n      </a>\n    </li>\n  "}output+="\n  ";if(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"dotted_lower",env.opts.autoescape)){output+='\n    <li><a href="#" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("urlparams").call(context,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"url",env.opts.autoescape),{page:1}),env.opts.autoescape);output+='">';output+=runtime.suppressValue(1,env.opts.autoescape);output+="</a></li>\n    ";if(runtime.memberLookup(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"page_range",env.opts.autoescape),0,env.opts.autoescape)!=2){output+='\n      <li class="skip">&hellip;</li>\n    '}output+="\n  "}output+="\n  ";frame=frame.push();var t_15=runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"page_range",env.opts.autoescape);if(t_15){var t_14=t_15.length;for(var t_13=0;t_13<t_15.length;t_13++){var t_16=t_15[t_13];frame.set("x",t_16);frame.set("loop.index",t_13+1);frame.set("loop.index0",t_13);frame.set("loop.revindex",t_14-t_13);frame.set("loop.revindex0",t_14-t_13-1);frame.set("loop.first",t_13===0);frame.set("loop.last",t_13===t_14-1);frame.set("loop.length",t_14);output+="\n    <li ";output+=runtime.suppressValue(env.getFilter("class_selected").call(context,t_16,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"number",env.opts.autoescape)),env.opts.autoescape);output+='>\n      <a href="#" class="';if(t_16==runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"number",env.opts.autoescape)){output+="btn-page"}output+='" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("urlparams").call(context,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"url",env.opts.autoescape),{page:t_16}),env.opts.autoescape);output+='">';output+=runtime.suppressValue(t_16,env.opts.autoescape);output+="</a>\n    </li>\n  "}}frame=frame.pop();output+="\n  ";if(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"page"),"dotted_upper",env.opts.autoescape)){output+="\n    ";if(runtime.memberLookup(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"page_range",env.opts.autoescape),-1,env.opts.autoescape)!=runtime.contextOrFrameLookup(context,frame,"num_pages")-1){output+='\n      <li class="skip">&hellip;</li>\n    '}output+='\n    <li><a href="#" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("urlparams").call(context,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"url",env.opts.autoescape),{page:runtime.contextOrFrameLookup(context,frame,"num_pages")}),env.opts.autoescape);output+='">';output+=runtime.suppressValue(runtime.contextOrFrameLookup(context,frame,"num_pages"),env.opts.autoescape);output+="</a></li>\n  "}output+="\n  ";if(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"has_next",env.opts.autoescape)){output+='\n    <li class="next">\n      <a class="btn-page btn-page-next" href="#" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("urlparams").call(context,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"url",env.opts.autoescape),{page:runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"number",env.opts.autoescape)+1}),env.opts.autoescape);output+='">\n        ';output+=runtime.suppressValue((lineno=85,colno=10,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Next"])),env.opts.autoescape);output+="\n      </a>\n    </li>\n  "}output+="\n  </ol>\n"}output+="\n";cb(null,output)})})}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["search-results.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{output+='<div id="search-results">\n  <div class="grid_3">\n    ';var t_1;t_1=runtime.contextOrFrameLookup(context,frame,"base_url");frame.set("base_doctype_url",t_1,true);if(!frame.parent){context.setVariable("base_doctype_url",t_1);context.addExport("base_doctype_url")}output+="\n    ";if(runtime.contextOrFrameLookup(context,frame,"product")){output+="\n      ";var t_2;t_2=env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_doctype_url"),runtime.makeKeywordArgs({product:runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"product"),"slug",env.opts.autoescape)}));frame.set("base_doctype_url",t_2,true);if(!frame.parent){context.setVariable("base_doctype_url",t_2);context.addExport("base_doctype_url")}output+="\n    "}output+="\n    ";var t_3;t_3=runtime.contextOrFrameLookup(context,frame,"base_url");frame.set("base_product_url",t_3,true);if(!frame.parent){context.setVariable("base_product_url",t_3);context.addExport("base_product_url")}output+="\n    ";if(runtime.contextOrFrameLookup(context,frame,"w")!=3){output+="\n      ";var t_4;t_4=env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_product_url"),runtime.makeKeywordArgs({w:runtime.contextOrFrameLookup(context,frame,"w")}));frame.set("base_product_url",t_4,true);if(!frame.parent){context.setVariable("base_product_url",t_4);context.addExport("base_product_url")}output+="\n    "}output+='\n    <ul id="product-filter" class="search-filter sidebar-nav">\n      <li ';output+=runtime.suppressValue(env.getFilter("class_selected").call(context,runtime.contextOrFrameLookup(context,frame,"product"),runtime.contextOrFrameLookup(context,frame,"null")),env.opts.autoescape);output+='>\n        <a href="#" data-instant-search-unset-params="product" data-instant-search-set-params="all_products=1" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_product_url"),runtime.makeKeywordArgs({all_products:1}))),env.opts.autoescape);output+='">\n          ';output+=runtime.suppressValue((lineno=13,colno=12,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["All Products"])),env.opts.autoescape);output+="\n        </a>\n      </li>\n      ";frame=frame.push();var t_7=runtime.contextOrFrameLookup(context,frame,"products");if(t_7){var t_6=t_7.length;for(var t_5=0;t_5<t_7.length;t_5++){var t_8=t_7[t_5];frame.set("p",t_8);frame.set("loop.index",t_5+1);frame.set("loop.index0",t_5);frame.set("loop.revindex",t_6-t_5);frame.set("loop.revindex0",t_6-t_5-1);frame.set("loop.first",t_5===0);frame.set("loop.last",t_5===t_6-1);frame.set("loop.length",t_6);output+="\n        <li ";output+=runtime.suppressValue(env.getFilter("class_selected").call(context,runtime.contextOrFrameLookup(context,frame,"product"),runtime.memberLookup(t_8,"slug",env.opts.autoescape)),env.opts.autoescape);output+='>\n          <a href="#" data-instant-search-set-params="product=';output+=runtime.suppressValue(runtime.memberLookup(t_8,"slug",env.opts.autoescape),env.opts.autoescape);output+='" data-instant-search-unset-params="all_products" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_product_url"),runtime.makeKeywordArgs({product:runtime.memberLookup(t_8,"slug",env.opts.autoescape)}))),env.opts.autoescape);output+='">\n            ';output+=runtime.suppressValue(runtime.memberLookup(t_8,"title",env.opts.autoescape),env.opts.autoescape);output+="\n          </a>\n        </li>\n      "}}frame=frame.pop();output+='\n    </ul>\n    <br />\n  </div>\n\n  <div class="grid_9" id="search-results-list">\n    ';env.getTemplate("search-results-list.html",false,"search-results.html",function(t_11,t_9){if(t_11){cb(t_11);return}t_9.render(context.getVariables(),frame.push(),function(t_12,t_10){if(t_12){cb(t_12);return}output+=t_10;output+="\n  </div>\n</div>\n";cb(null,output)})})}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["wiki-related-doc.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{output+='<li data-pk="';output+=runtime.suppressValue(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"doc"),"id",env.opts.autoescape),env.opts.autoescape);output+='">\n  <input type="checkbox" name="';output+=runtime.suppressValue(runtime.contextOrFrameLookup(context,frame,"name"),env.opts.autoescape);output+='" value="';output+=runtime.suppressValue(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"doc"),"id",env.opts.autoescape),env.opts.autoescape);output+='" checked />\n  ';output+=runtime.suppressValue(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"doc"),"title",env.opts.autoescape),env.opts.autoescape);output+='\n  <span data-close-type="remove" class="close-button"></span>\n</li>\n';cb(null,output)}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["wiki-search-results.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{output+="<ul>\n  ";frame=frame.push();var t_3=runtime.contextOrFrameLookup(context,frame,"results");if(t_3){var t_2=t_3.length;for(var t_1=0;t_1<t_3.length;t_1++){var t_4=t_3[t_1];frame.set("doc",t_4);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+='\n    <li data-pk="';output+=runtime.suppressValue(runtime.memberLookup(t_4,"id",env.opts.autoescape),env.opts.autoescape);output+='">';output+=runtime.suppressValue(runtime.memberLookup(t_4,"title",env.opts.autoescape),env.opts.autoescape);output+="</li>\n  "}}frame=frame.pop();output+="\n</ul>\n";cb(null,output)}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["macros.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{var macro_t_1=runtime.makeMacro(["result"],[],function(l_result,kwargs){frame=frame.push();kwargs=kwargs||{};if(kwargs.hasOwnProperty("caller")){frame.set("caller",kwargs.caller)}frame.set("result",l_result);var t_2="";t_2+='\n  <div class="result ';t_2+=runtime.suppressValue(runtime.memberLookup(l_result,"type",env.opts.autoescape),env.opts.autoescape);t_2+='">\n    <h3><a class="title" href="';t_2+=runtime.suppressValue(runtime.memberLookup(l_result,"url",env.opts.autoescape),env.opts.autoescape);t_2+='" data-event-category="Instant Search" data-event-action="Result Clicked">';t_2+=runtime.suppressValue(runtime.memberLookup(l_result,"title",env.opts.autoescape),env.opts.autoescape);t_2+="</a></h3>\n    ";if(runtime.memberLookup(l_result,"type",env.opts.autoescape)=="question"){t_2+='\n      <ul class="thread-meta cf">\n        ';if(runtime.memberLookup(l_result,"is_solved",env.opts.autoescape)){t_2+="\n          <li>";t_2+=runtime.suppressValue((lineno=6,colno=16,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Solved"])),env.opts.autoescape);t_2+="</li>\n        "}t_2+="\n        <li>\n          ";if(runtime.memberLookup(l_result,"num_answers",env.opts.autoescape)>0){t_2+="\n            ";t_2+=runtime.suppressValue(env.getFilter("f").call(context,(lineno=10,colno=21,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"ngettext"),"ngettext",["1 reply","%s replies",runtime.memberLookup(l_result,"num_answers",env.opts.autoescape)])),[runtime.memberLookup(l_result,"num_answers",env.opts.autoescape)]),env.opts.autoescape);t_2+="\n          "}else{t_2+="\n            ";t_2+=runtime.suppressValue((lineno=12,colno=14,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["No replies"])),env.opts.autoescape);t_2+="\n          "}t_2+="\n        </li>\n        <li>\n          ";t_2+=runtime.suppressValue(env.getFilter("f").call(context,(lineno=16,colno=19,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"ngettext"),"ngettext",["1 person has this problem","%s people have this problem",runtime.memberLookup(l_result,"num_votes",env.opts.autoescape)])),[runtime.memberLookup(l_result,"num_votes",env.opts.autoescape)]),env.opts.autoescape);t_2+="\n        </li>\n        <li>\n          ";t_2+=runtime.suppressValue(env.getFilter("f").call(context,(lineno=19,colno=19,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"ngettext"),"ngettext",["1 new this week","%s new this week",runtime.memberLookup(l_result,"num_votes_past_week",env.opts.autoescape)])),[runtime.memberLookup(l_result,"num_votes_past_week",env.opts.autoescape)]),env.opts.autoescape);t_2+="\n        </li>\n      </ul>\n    "}t_2+='\n    <a tabindex="-1" href="';t_2+=runtime.suppressValue(runtime.memberLookup(l_result,"url",env.opts.autoescape),env.opts.autoescape);t_2+='" data-event-category="Instant Search" data-event-action="Result Clicked">';t_2+=runtime.suppressValue(env.getFilter("safe").call(context,runtime.memberLookup(l_result,"search_summary",env.opts.autoescape)),env.opts.autoescape);t_2+="</a>\n  </div>\n";frame=frame.pop();return new runtime.SafeString(t_2)});context.addExport("search_result");context.setVariable("search_result",macro_t_1);output+="\n";cb(null,output)}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["mobile-product-search-results.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{output+='<div class="search-header">';output+=runtime.suppressValue((lineno=0,colno=29,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Search results"])),env.opts.autoescape);output+='</div>\n<ul class="document-list">\n  ';if(runtime.contextOrFrameLookup(context,frame,"num_results")>0){output+="\n    ";frame=frame.push();var t_3=runtime.contextOrFrameLookup(context,frame,"results");if(t_3){var t_2=t_3.length;for(var t_1=0;t_1<t_3.length;t_1++){var t_4=t_3[t_1];frame.set("doc",t_4);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+='\n      <li>\n        <a href="';output+=runtime.suppressValue(runtime.memberLookup(t_4,"url",env.opts.autoescape),env.opts.autoescape);output+='">';output+=runtime.suppressValue(runtime.memberLookup(t_4,"title",env.opts.autoescape),env.opts.autoescape);output+="</a>\n      </li>\n    "}}frame=frame.pop();output+="\n  "}else{output+='\n    <li><a href="#">';output+=runtime.suppressValue((lineno=9,colno=22,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["No results found."])),env.opts.autoescape);output+="</a></li>\n  "}output+="\n</ul>\n";cb(null,output)}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["mobile-search-results.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{if(runtime.contextOrFrameLookup(context,frame,"results")){output+='\n  <ol class="search-results">\n    ';frame=frame.push();var t_3=runtime.contextOrFrameLookup(context,frame,"results");if(t_3){var t_2=t_3.length;for(var t_1=0;t_1<t_3.length;t_1++){var t_4=t_3[t_1];frame.set("doc",t_4);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+='\n      <li class="';output+=runtime.suppressValue(runtime.memberLookup(t_4,"type",env.opts.autoescape),env.opts.autoescape);output+='">\n        <a href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,env.getFilter("urlparams").call(context,runtime.memberLookup(t_4,"url",env.opts.autoescape),runtime.makeKeywordArgs({s:runtime.contextOrFrameLookup(context,frame,"q"),as:"s"}))),env.opts.autoescape);output+='">\n          <span class="title">';output+=runtime.suppressValue(runtime.memberLookup(t_4,"title",env.opts.autoescape),env.opts.autoescape);output+="</span>\n          ";output+=runtime.suppressValue(env.getFilter("safe").call(context,runtime.memberLookup(t_4,"search_summary",env.opts.autoescape)),env.opts.autoescape);output+="\n        </a>\n      </li>\n    "}}frame=frame.pop();output+="\n  </ol>\n"}else{output+="\n  ";output+=runtime.suppressValue((lineno=12,colno=4,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["No results found"])),env.opts.autoescape);output+="\n"}output+="\n";cb(null,output)}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["search-results-list.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{env.getTemplate("macros.html",false,"search-results-list.html",function(t_2,t_1){if(t_2){cb(t_2);return}t_1.getExported(function(t_3,t_1){if(t_3){cb(t_3);return}if(t_1.hasOwnProperty("search_result")){var t_4=t_1.search_result}else{cb(new Error("cannot import 'search_result'"));return}context.setVariable("search_result",t_4);output+="\n\n";if(runtime.contextOrFrameLookup(context,frame,"num_results")>0){output+="\n  <h2>\n    ";output+="\n    ";output+=runtime.suppressValue(env.getFilter("safe").call(context,env.getFilter("f").call(context,(lineno=5,colno=13,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"ngettext"),"ngettext",["Found <strong>%(n)s</strong> result for <strong>%(q)s</strong> for <strong>%(product)s</strong>","Found <strong>%(n)s</strong> results for <strong>%(q)s</strong> for <strong>%(product)s</strong>",runtime.contextOrFrameLookup(context,frame,"num_results")])),{n:runtime.contextOrFrameLookup(context,frame,"num_results"),q:runtime.contextOrFrameLookup(context,frame,"q"),product:runtime.contextOrFrameLookup(context,frame,"product_titles")},true)),env.opts.autoescape);output+='\n  </h2>\n\n  <ul id="doctype-filter" class="search-filter cf">\n    <li ';output+=runtime.suppressValue(env.getFilter("class_selected").call(context,runtime.contextOrFrameLookup(context,frame,"w"),3),env.opts.autoescape);output+='>\n      <a href="#" data-instant-search-set-params="w=3" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,runtime.contextOrFrameLookup(context,frame,"base_doctype_url")),env.opts.autoescape);output+='">\n        <img alt="copy" class="show-everything" src="/static/sumo/img/icon-copy.png"/>\n        ';output+=runtime.suppressValue((lineno=16,colno=10,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Show Everything"])),env.opts.autoescape);output+="\n      </a>\n    </li>\n    <li ";output+=runtime.suppressValue(env.getFilter("class_selected").call(context,runtime.contextOrFrameLookup(context,frame,"w"),1),env.opts.autoescape);output+='>\n      <a href="#" data-instant-search-set-params="w=1" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_doctype_url"),runtime.makeKeywordArgs({w:1}))),env.opts.autoescape);output+='">\n        <img alt="file" class="help-articles" src="/static/sumo/img/icon-file.png"/>\n        ';output+=runtime.suppressValue((lineno=22,colno=10,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Help Articles Only"])),env.opts.autoescape);output+="\n      </a>\n    </li>\n    <li ";output+=runtime.suppressValue(env.getFilter("class_selected").call(context,runtime.contextOrFrameLookup(context,frame,"w"),2),env.opts.autoescape);output+='>\n      <a href="#" data-instant-search-set-params="w=2" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_doctype_url"),runtime.makeKeywordArgs({w:2}))),env.opts.autoescape);output+='">\n        <img alt="discuss" class="community-discussion" src="/static/sumo/img/icon-discuss.png"/>\n        ';output+=runtime.suppressValue((lineno=28,colno=10,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Community Discussion Only"])),env.opts.autoescape);output+='\n      </a>\n    </li>\n  </ul>\n\n  <div class="content-box">\n    ';frame=frame.push();var t_7=runtime.contextOrFrameLookup(context,frame,"results");if(t_7){var t_6=t_7.length;for(var t_5=0;t_5<t_7.length;t_5++){var t_8=t_7[t_5];frame.set("doc",t_8);frame.set("loop.index",t_5+1);frame.set("loop.index0",t_5);frame.set("loop.revindex",t_6-t_5);frame.set("loop.revindex0",t_6-t_5-1);frame.set("loop.first",t_5===0);frame.set("loop.last",t_5===t_6-1);frame.set("loop.length",t_6);output+="\n      ";output+=runtime.suppressValue((lineno=35,colno=20,runtime.callWrap(t_4,"search_result",[t_8])),env.opts.autoescape);output+="\n    "}}frame=frame.pop();output+="\n  </div>\n"}else{output+="\n  <h2>\n    ";output+="\n    ";output+=runtime.suppressValue(env.getFilter("safe").call(context,env.getFilter("f").call(context,(lineno=41,colno=6,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["We couldn't find any results for <strong>%(q)s</strong> in <strong>%(l)s</strong>. Maybe one of these articles will be helpful?"])),{q:runtime.contextOrFrameLookup(context,frame,"q"),l:runtime.contextOrFrameLookup(context,frame,"lang_name")},true)),env.opts.autoescape);output+='\n  </h2>\n\n  <div class="content-box">\n    ';frame=frame.push();var t_11=runtime.contextOrFrameLookup(context,frame,"fallback_results");if(t_11){var t_10=t_11.length;for(var t_9=0;t_9<t_11.length;t_9++){var t_12=t_11[t_9];frame.set("doc",t_12);frame.set("loop.index",t_9+1);frame.set("loop.index0",t_9);frame.set("loop.revindex",t_10-t_9);frame.set("loop.revindex0",t_10-t_9-1);frame.set("loop.first",t_9===0);frame.set("loop.last",t_9===t_10-1);frame.set("loop.length",t_10);output+='\n      <div class="result document">\n        <h3><a class="title" href="';output+=runtime.suppressValue(runtime.memberLookup(t_12,"url",env.opts.autoescape),env.opts.autoescape);output+='">';output+=runtime.suppressValue(runtime.memberLookup(t_12,"document_title",env.opts.autoescape),env.opts.autoescape);output+='</a></h3>\n        <a tabindex="-1" href="';output+=runtime.suppressValue(runtime.memberLookup(t_12,"url",env.opts.autoescape),env.opts.autoescape);output+='">';output+=runtime.suppressValue(runtime.memberLookup(t_12,"document_summary",env.opts.autoescape),env.opts.autoescape);output+="</a>\n      </div>\n    "}}frame=frame.pop();output+="\n  </div>\n"}output+="\n\n";if(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"num_pages",env.opts.autoescape)>1){output+='\n  <ol class="pagination cf">\n  ';if(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"has_previous",env.opts.autoescape)){output+='\n    <li class="prev">\n      <a class="btn-page btn-page-prev" href="#" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("urlparams").call(context,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"url",env.opts.autoescape),{page:runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"number",env.opts.autoescape)-1}),env.opts.autoescape);output+='">\n        ';output+=runtime.suppressValue((lineno=61,colno=10,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Previous"])),env.opts.autoescape);output+="\n      </a>\n    </li>\n  "}output+="\n  ";if(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"dotted_lower",env.opts.autoescape)){output+='\n    <li><a href="#" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("urlparams").call(context,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"url",env.opts.autoescape),{page:1}),env.opts.autoescape);output+='">';output+=runtime.suppressValue(1,env.opts.autoescape);output+="</a></li>\n    ";if(runtime.memberLookup(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"page_range",env.opts.autoescape),0,env.opts.autoescape)!=2){output+='\n      <li class="skip">&hellip;</li>\n    '}output+="\n  "}output+="\n  ";frame=frame.push();var t_15=runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"page_range",env.opts.autoescape);if(t_15){var t_14=t_15.length;for(var t_13=0;t_13<t_15.length;t_13++){var t_16=t_15[t_13];frame.set("x",t_16);frame.set("loop.index",t_13+1);frame.set("loop.index0",t_13);frame.set("loop.revindex",t_14-t_13);frame.set("loop.revindex0",t_14-t_13-1);frame.set("loop.first",t_13===0);frame.set("loop.last",t_13===t_14-1);frame.set("loop.length",t_14);output+="\n    <li ";output+=runtime.suppressValue(env.getFilter("class_selected").call(context,t_16,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"number",env.opts.autoescape)),env.opts.autoescape);output+='>\n      <a href="#" class="';if(t_16==runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"number",env.opts.autoescape)){output+="btn-page"}output+='" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("urlparams").call(context,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"url",env.opts.autoescape),{page:t_16}),env.opts.autoescape);output+='">';output+=runtime.suppressValue(t_16,env.opts.autoescape);output+="</a>\n    </li>\n  "}}frame=frame.pop();output+="\n  ";if(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"page"),"dotted_upper",env.opts.autoescape)){output+="\n    ";if(runtime.memberLookup(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"page_range",env.opts.autoescape),-1,env.opts.autoescape)!=runtime.contextOrFrameLookup(context,frame,"num_pages")-1){output+='\n      <li class="skip">&hellip;</li>\n    '}output+='\n    <li><a href="#" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("urlparams").call(context,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"url",env.opts.autoescape),{page:runtime.contextOrFrameLookup(context,frame,"num_pages")}),env.opts.autoescape);output+='">';output+=runtime.suppressValue(runtime.contextOrFrameLookup(context,frame,"num_pages"),env.opts.autoescape);output+="</a></li>\n  "}output+="\n  ";if(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"has_next",env.opts.autoescape)){output+='\n    <li class="next">\n      <a class="btn-page btn-page-next" href="#" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("urlparams").call(context,runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"url",env.opts.autoescape),{page:runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"pagination"),"number",env.opts.autoescape)+1}),env.opts.autoescape);output+='">\n        ';output+=runtime.suppressValue((lineno=85,colno=10,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["Next"])),env.opts.autoescape);output+="\n      </a>\n    </li>\n  "}output+="\n  </ol>\n"}output+="\n";cb(null,output)})})}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["search-results.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{output+='<div id="search-results">\n  <div class="grid_3">\n    ';var t_1;t_1=runtime.contextOrFrameLookup(context,frame,"base_url");frame.set("base_doctype_url",t_1,true);if(!frame.parent){context.setVariable("base_doctype_url",t_1);context.addExport("base_doctype_url")}output+="\n    ";if(runtime.contextOrFrameLookup(context,frame,"product")){output+="\n      ";var t_2;t_2=env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_doctype_url"),runtime.makeKeywordArgs({product:runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"product"),"slug",env.opts.autoescape)}));frame.set("base_doctype_url",t_2,true);if(!frame.parent){context.setVariable("base_doctype_url",t_2);context.addExport("base_doctype_url")}output+="\n    "}output+="\n    ";var t_3;t_3=runtime.contextOrFrameLookup(context,frame,"base_url");frame.set("base_product_url",t_3,true);if(!frame.parent){context.setVariable("base_product_url",t_3);context.addExport("base_product_url")}output+="\n    ";if(runtime.contextOrFrameLookup(context,frame,"w")!=3){output+="\n      ";var t_4;t_4=env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_product_url"),runtime.makeKeywordArgs({w:runtime.contextOrFrameLookup(context,frame,"w")}));frame.set("base_product_url",t_4,true);if(!frame.parent){context.setVariable("base_product_url",t_4);context.addExport("base_product_url")}output+="\n    "}output+='\n    <ul id="product-filter" class="search-filter sidebar-nav">\n      <li ';output+=runtime.suppressValue(env.getFilter("class_selected").call(context,runtime.contextOrFrameLookup(context,frame,"product"),runtime.contextOrFrameLookup(context,frame,"null")),env.opts.autoescape);output+='>\n        <a href="#" data-instant-search-unset-params="product" data-instant-search-set-params="all_products=1" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_product_url"),runtime.makeKeywordArgs({all_products:1}))),env.opts.autoescape);output+='">\n          ';output+=runtime.suppressValue((lineno=13,colno=12,runtime.callWrap(runtime.contextOrFrameLookup(context,frame,"_"),"_",["All Products"])),env.opts.autoescape);output+="\n        </a>\n      </li>\n      ";frame=frame.push();var t_7=runtime.contextOrFrameLookup(context,frame,"products");if(t_7){var t_6=t_7.length;for(var t_5=0;t_5<t_7.length;t_5++){var t_8=t_7[t_5];frame.set("p",t_8);frame.set("loop.index",t_5+1);frame.set("loop.index0",t_5);frame.set("loop.revindex",t_6-t_5);frame.set("loop.revindex0",t_6-t_5-1);frame.set("loop.first",t_5===0);frame.set("loop.last",t_5===t_6-1);frame.set("loop.length",t_6);output+="\n        <li ";output+=runtime.suppressValue(env.getFilter("class_selected").call(context,runtime.contextOrFrameLookup(context,frame,"product"),runtime.memberLookup(t_8,"slug",env.opts.autoescape)),env.opts.autoescape);output+='>\n          <a href="#" data-instant-search-set-params="product=';output+=runtime.suppressValue(runtime.memberLookup(t_8,"slug",env.opts.autoescape),env.opts.autoescape);
output+='" data-instant-search-unset-params="all_products" data-instant-search="link" data-href="';output+=runtime.suppressValue(env.getFilter("encodeURI").call(context,env.getFilter("urlparams").call(context,runtime.contextOrFrameLookup(context,frame,"base_product_url"),runtime.makeKeywordArgs({product:runtime.memberLookup(t_8,"slug",env.opts.autoescape)}))),env.opts.autoescape);output+='">\n            ';output+=runtime.suppressValue(runtime.memberLookup(t_8,"title",env.opts.autoescape),env.opts.autoescape);output+="\n          </a>\n        </li>\n      "}}frame=frame.pop();output+='\n    </ul>\n    <br />\n  </div>\n\n  <div class="grid_9" id="search-results-list">\n    ';env.getTemplate("search-results-list.html",false,"search-results.html",function(t_11,t_9){if(t_11){cb(t_11);return}t_9.render(context.getVariables(),frame.push(),function(t_12,t_10){if(t_12){cb(t_12);return}output+=t_10;output+="\n  </div>\n</div>\n";cb(null,output)})})}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["wiki-related-doc.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{output+='<li data-pk="';output+=runtime.suppressValue(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"doc"),"id",env.opts.autoescape),env.opts.autoescape);output+='">\n  <input type="checkbox" name="';output+=runtime.suppressValue(runtime.contextOrFrameLookup(context,frame,"name"),env.opts.autoescape);output+='" value="';output+=runtime.suppressValue(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"doc"),"id",env.opts.autoescape),env.opts.autoescape);output+='" checked />\n  ';output+=runtime.suppressValue(runtime.memberLookup(runtime.contextOrFrameLookup(context,frame,"doc"),"title",env.opts.autoescape),env.opts.autoescape);output+='\n  <span data-close-type="remove" class="close-button"></span>\n</li>\n';cb(null,output)}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["wiki-search-results.html"]=function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{output+="<ul>\n  ";frame=frame.push();var t_3=runtime.contextOrFrameLookup(context,frame,"results");if(t_3){var t_2=t_3.length;for(var t_1=0;t_1<t_3.length;t_1++){var t_4=t_3[t_1];frame.set("doc",t_4);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+='\n    <li data-pk="';output+=runtime.suppressValue(runtime.memberLookup(t_4,"id",env.opts.autoescape),env.opts.autoescape);output+='">';output+=runtime.suppressValue(runtime.memberLookup(t_4,"title",env.opts.autoescape),env.opts.autoescape);output+="</li>\n  "}}frame=frame.pop();output+="\n</ul>\n";cb(null,output)}catch(e){cb(runtime.handleError(e,lineno,colno))}}return{root:root}}()})();(function($){var searchTimeout;var locale=$("html").attr("lang");var $searchField=$("#search-related");var $relatedDocsList=$("#related-docs-list");var $resultsList;var search=new k.Search("/"+locale+"/search",{w:1,format:"json"});function createResultsList(){$resultsList=$("<div />").addClass("input-dropdown");$searchField.after($resultsList);$resultsList.css("width",$searchField.outerWidth());$resultsList.show();$resultsList.on("click","[data-pk]",function(){var $this=$(this);$relatedDocsList.children(".empty-message").remove();if(!$relatedDocsList.children("[data-pk="+$this.data("pk")+"]").length){var context={name:"related_documents",doc:{id:$this.data("pk"),title:$this.text()}};$relatedDocsList.append(k.nunjucksEnv.render("wiki-related-doc.html",context))}})}function showResults(data){if(!$resultsList){createResultsList()}$resultsList.html(k.nunjucksEnv.render("wiki-search-results.html",data))}function handleSearch(){var $this=$(this);if($this.val().length===0){window.clearTimeout(searchTimeout);if($resultsList){$resultsList.html("");$resultsList.hide()}}else if($this.val()!==search.lastQuery){window.clearTimeout(searchTimeout);searchTimeout=window.setTimeout(function(){search.query($this.val(),showResults)},200)}}$searchField.on("keyup",handleSearch);$searchField.on("focus",function(){if($resultsList){$resultsList.show()}});$searchField.on("blur",function(){if($resultsList){window.setTimeout(function(){$resultsList.hide()},100)}})})(jQuery);
